{"version":3,"sources":["theme/index.js","reducers/DataReducer.js","rootreducer.js","Store.js","client/environment.js","client/index.jsx","components/Input.js","components/nav.js","components/spectrum/auxi.js","components/spectrum/interactiveObject.js","components/spectrum/graphics.js","components/spectrum/plant.js","components/spectrum/handle.js","components/spectrum/lightGraphic.js","components/spectrum/light.js","components/spectrum/mirror.js","components/spectrum/grid.js","components/spectrum/index.js","components/sensorTypes.js","components/plants.js","components/countdown.js","components/controller.js","components/score.js","components/LoaderScreen.js","components/game.js","services/Buildertheme.js","components/Home.js","App.js","serviceWorker.js","index.js","assets/logo.svg"],"names":["Theme","this","colors","primary","secondary","tertiary","text","defaultWrapWidth","font","sizes","normal","title","subtitle","medias","em","xs","sm","md","lg","px","query","onlySmall","largerthansm","mdandup","smallerthanmd","padding","styled","pre","values","post","children","EmptyDiv","content","defaultWrap","responsive","EmptySpan","defaultFont","div","Title","props","border","span","ACTIONS","Object","freeze","SET_CLIENT","Symbol","SET_NAV_OPEN","SET_THEME","SET_THEMES","SET_NEWS","SET_EVENTS","SET_FAQS","SET_SENSOR_TYPES","SET_PLANT_CLUSTERS","SET_SOCKET","SET_GAME_SETTINGS","initialState","client","navopen","window","innerWidth","theme","themes","news","events","faqs","sensorTypes","plantClusters","socket","gameSettings","rootReducer","combineReducers","data","state","action","type","SET_SELECTED","selected","middleware","applyMiddleware","thunkMiddleware","Store","createStore","envi","dev","location","hostname","status","document","printstatus","console","log","dispatch","settings","io","transports","DATA_ACTIONS","on","Input","Nav","useSelector","center","to","src","Logo","style","width","Text","color","fontSize","fontWeight","Container","getPointOnCircle","p5","centrum","offset","division","section","angle","Math","PI","pos","createVector","cos","sin","mult","add","sqr","x","dist2","v","w","y","distToSegment","p","sqrt","l2","t","max","min","distToSegmentSquared","IO_STATE","UNSELECTED","CLICKED","HOVERING","DRAGGED","InteractiveObject","size","easer","target","value","easing","checkChanged","rv","changed","loc","dist","isOver","mouseX","mouseY","isCurrentOver","mouseMoved","Flower","mainSegments","secondarySegments","tertiarySegments","strokeColor","rotationFactor","mainSegmentScale","random","mainStartpoint","secondarySegmentscale","secondaryStartpoint","tertiarySegmentscale","tertiaryStartpoint","i","s1","BigSpine","setstrokeWeight","setRotation","enableRotation","setRotationSpeed","s2","flipVertical","push","SmallSpine","length","setRotationFactor","draw","pop","f","c","setColor","FlowerSegment","scaleFactor","rotation","scale","translation","branches","branchPoints","strokeWeight","rotationSpeed","r","randomAdjust","sw","rotate","newBranch","setTranslation","newLeaf","Leaf","translate","stroke","noFill","bezier","debug","circle","bp","Plant","alternativeColor","onClick","grid","collisionColor","colorplaceholder","currentColors","red","green","blue","flower","FlowerGraphic","ceil","coords","nearestGridPoint","lights","col","currenctColors","light","j","beam","segments","segment","line_v","p1_x","p1_y","line_w","p2_x","p2_y","point","noStroke","fill","millis","Handle","circleSize","direction","mousePos","mouseV","diff","set","sub","normalize","handlePosition","handleOffset","setMag","Light","line","beginShape","vertex","endShape","Segment","mirror","Beam","origin","mirrors","intersectPoints","startPoint","cnt","pow","height","reflectionData","reflect","reflectionStart","cast","beamStart","beamEnd","intersectionPoints","mirrorStart","getPoints","mirrorEnd","u","distance","ID","reflectionNormal","getReflection","intersectionPoint","sort","a","b","normDirection","reflectVector","controlOffset","hide","player","lightGraphic","LightGraphic","randDirection","handle","getDirection","angleBetween","iPlay","mousePressed","mouseReleased","mouseDragged","Mirror","reflectionNormals","tester","adjustV","adjust","endPoint","tx","ty","linePoints","degrees","iPlayer","Grid","spacing","xCnt","yCnt","diam","round","players","scoreUpdate","safeDistance","Map","plants","toDraw","toInteract","lightSettings","plantSettings","amount","mirrorSettings","getCenter","setup","canvasParentRef","offsetWidth","createCanvas","screen","parent","gameUpdate","forEach","arr","emit","index","newmirror","rx","ry","setNormalizedLocation","m","dir","get","l","background","td","mr","detectCollision","frameCount","score","map","ti","SensorType","name","description","useState","open","setOpen","className","SensorTypes","st","key","Sensor","useEffect","sensors","init","s","Plants","Countdown","displaytext","endText","rt","setrt","count","setCount","int","setInterval","floor","abs","Date","getTime","clearInterval","Controller","phase","phases","setPlantClusters","setSelected","setScore","highScore","setHighScore","selector","score_","highscore_","off","getVal","getSelected","RUNNING","HS1","HSA","Score","LoaderScreen","setPlayer","MakePlayer","killed","toUpperCase","textAlign","Game","PHASES","LOAD","END","start","setStart","setPhase","setPlayers","setTarget","listeners","setListeners","useDispatch","useFullScreenHandle","setTargetFromDate","seconds","d","setSeconds","getSeconds","newphase","beginningTime","duration","newplayers","enter","Empty","margin","borderLeft","BuilderTheme","Home","newsref","useRef","getEvents","available","moment","SubTitle","format","blocks","align","Wrapped","ref","images","image","alt","filter","e","today","yesterday","setDate","getDate","DataHelper","cli","sanityclient","App","history","createBrowserHistory","store","minWidth","exact","path","component","Boolean","match","ReactDOM","render","StrictMode","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","error","message","module","exports"],"mappings":"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","file":"static/js/main.49cbd962.chunk.js","sourcesContent":["import React from 'react'\r\nimport styled from 'styled-components'\r\nimport \"./theme.css\"\r\nimport Overview from './pages/overview'\r\nexport {Grid, Col, Row } from 'react-styled-flexboxgrid';\r\n/* \r\n    - TOAST\r\n    - support multiple themes\r\n    - set basic html (background etc)\r\n    - build in version control\r\n    - Text\r\n    - Title\r\n    - Subtitle\r\n    - Container\r\n    - CollapsibleContainer\r\n    - Button\r\n*/\r\n\r\nexport const OverviewPage = Overview;\r\n\r\nlet settings = {\r\n    \r\n};\r\n\r\nclass Theme {\r\n    constructor() {\r\n        this.colors = {\r\n          primary: \"black\",\r\n          secondary: \"white\",\r\n          tertiary: \"red\"\r\n        };\r\n\r\n        this.colors.text = {\r\n            primary: this.colors.secondary,\r\n            secondary: this.colors.primary\r\n        }\r\n\r\n        this.defaultWrapWidth = 3;\r\n\r\n        this.font = \"American Typewriter\"\r\n\r\n        this.sizes = {\r\n            normal: \"1.2em\",\r\n            title: \"2em\",\r\n            subtitle: \"1.4em\"\r\n        }\r\n\r\n        this.medias = {\r\n          em: {\r\n            xs: 0,  \r\n            sm: 48, \r\n            md: 64, \r\n            lg: 75\r\n          }, \r\n          px: {\r\n            xs: 0,  \r\n            sm: 768, \r\n            md: 1024, \r\n            lg: 5625\r\n          }\r\n        }\r\n\r\n        this.medias.query = {\r\n            onlySmall : `(max-width: ${this.medias.px.sm}px)`,\r\n            largerthansm : `(min-width: ${this.medias.px.sm+1}px)`,\r\n            mdandup : `(min-width: ${this.medias.px.md}px)`,\r\n            smallerthanmd : `(max-width: ${this.medias.px.md-1}px)`\r\n        }\r\n\r\n        this.padding = {\r\n            xs: 10,  \r\n            sm: 15, \r\n            md: 20, \r\n            lg: 30\r\n        };\r\n    }\r\n    \r\n    /**\r\n     * HELPERS\r\n     */\r\n    get defaultWrap(){\r\n        return `solid ${this.colors.primary} ${this.defaultWrapWidth}px`\r\n    }\r\n\r\n    get defaultFont(){\r\n        return `font-family : ${this.font}; font-size: ${this.sizes.normal};`\r\n    }\r\n\r\n    get styled(){\r\n        return styled;\r\n    }\r\n\r\n    responsive(pre, values, post){\r\n        return `\r\n            ${pre}: ${values.xs}${post};\r\n\r\n            @media only screen and (min-width: ${this.medias.px.sm}px) {\r\n                ${pre}: ${values.sm}${post};\r\n            }\r\n\r\n            @media only screen and (min-width: ${this.medias.px.md}px) {\r\n                ${pre}: ${values.md}${post};\r\n            }        \r\n\r\n            @media only screen and (min-width: ${this.medias.px.lg}px) {\r\n                ${pre}: ${values.lg}${post};\r\n            }        \r\n        `\r\n    }\r\n    \r\n    /**\r\n     * COMPONENTS\r\n     */\r\n    /**\r\n     * wrapping\r\n     */\r\n    get Wrapped(){\r\n        return ({children})=><EmptyDiv content={`border : ${this.defaultWrap}; background: white;`}>{children}</EmptyDiv>\r\n    }\r\n\r\n    get Container(){\r\n        return ({children})=><EmptyDiv content={this.responsive(\"padding\", this.padding, 'px')}>{children}</EmptyDiv>\r\n    }\r\n\r\n    get Empty(){\r\n        return ({children})=><EmptyDiv >{children}</EmptyDiv>\r\n    }\r\n\r\n    get Text(){\r\n        return ({children})=><EmptySpan content={this.defaultFont}>{children}</EmptySpan>\r\n    }\r\n\r\n    // get Container(){\r\n    //     return styled.div`\r\n    //         padding: ${this.padding}\r\n    //     `\r\n    // } \r\n\r\n    // test\r\n\r\n    // /**\r\n    //  * typography\r\n    //  */\r\n    // get Text(){\r\n    //     return styled.p`\r\n    //         ${this.defaultFont}\r\n    //     `\r\n    // }\r\n\r\n    get Title(){\r\n        // return ({children})=><EmptySpan content={this.defaultFont}>{children}</EmptySpan>\r\n        return styled.div`\r\n            ${this.defaultFont}\r\n            font-size: ${this.sizes.title}; \r\n            font-weight: bold;\r\n        `\r\n    }\r\n\r\n    get SubTitle(){\r\n        return styled(this.Title)`\r\n            font-size: ${this.sizes.subtitle}; \r\n        `\r\n    }\r\n\r\n    // /**\r\n    //  * grid\r\n    //  */\r\n    // get Grid(){\r\n    //     return styled(Grid_)`\r\n    //         margin: 0px;\r\n    //         padding: 0px;\r\n    //         width: 100%;\r\n    //     `\r\n    // }\r\n\r\n    // get Row(){return Row_};\r\n    // get Col(){return Col_};\r\n}\r\n\r\nconst Wrapped = styled.div`\r\n    border: ${props=>props.border}\r\n`\r\n\r\nconst EmptyDiv = styled.div`\r\n    ${props=>props.content}\r\n    \r\n`\r\n\r\nconst EmptySpan = styled.span`\r\n    ${props=>props.content}\r\n`\r\n\r\n\r\nexport default Theme;","export const ACTIONS = Object.freeze({\r\n    SET_CLIENT: Symbol(\"data/client\"),\r\n    SET_NAV_OPEN: Symbol('data/navopen'),\r\n    SET_THEME: Symbol('data/theme'),\r\n    SET_THEMES: Symbol('data/themes'),\r\n    SET_NEWS: Symbol('data/news'),\r\n    SET_EVENTS: Symbol('data/cal'),\r\n    SET_FAQS: Symbol('data/faq'),\r\n    SET_SENSOR_TYPES: Symbol('data/svt'),\r\n    SET_PLANT_CLUSTERS: Symbol('data/pc'),\r\n    SET_SOCKET: Symbol('socket'),\r\n    SET_GAME_SETTINGS: Symbol('gamesettings'),\r\n});\r\n\r\nconst initialState = {\r\n  client: null,\r\n  navopen: window.innerWidth > 768,\r\n  theme: null,\r\n  themes: null,\r\n  news: null,\r\n  events: null,\r\n  faqs: null,\r\n  sensorTypes: null,\r\n  plantClusters: null,\r\n  socket: null,\r\n  gameSettings: null,\r\n};\r\n\r\nexport default (state = initialState, action) => {\r\n  \r\n  switch (action.type) {\r\n    case ACTIONS.SET_SELECTED : {\r\n      return {\r\n        ...state,\r\n        selected: action.selected\r\n      }\r\n    }\r\n    case ACTIONS.SET_CLIENT: {\r\n      return {\r\n        ...state,\r\n        client: action.client\r\n      };\r\n    }\r\n    case ACTIONS.SET_SENSOR_TYPES: {\r\n      return {\r\n        ...state,\r\n        sensorTypes: action.sensorTypes\r\n      };\r\n    }\r\n    case ACTIONS.SET_GAME_SETTINGS: {\r\n      return {\r\n        ...state,\r\n        gameSettings: action.gameSettings\r\n      };\r\n    }\r\n    case ACTIONS.SET_SOCKET: {\r\n      return {\r\n        ...state,\r\n        socket: action.socket\r\n      };\r\n    }\r\n    case ACTIONS.SET_PLANT_CLUSTERS: {\r\n      return {\r\n        ...state,\r\n        plantClusters: action.plantClusters\r\n      };\r\n    }\r\n    case ACTIONS.SET_NEWS: {\r\n      return {\r\n        ...state,\r\n        news: action.news\r\n      };\r\n    }\r\n    case ACTIONS.SET_EVENTS: {\r\n      return {\r\n        ...state,\r\n        events: action.events\r\n      };\r\n    }\r\n    case ACTIONS.SET_NAV_OPEN: {\r\n      return {\r\n        ...state,\r\n        navopen: action.navopen\r\n      };\r\n    }\r\n    case ACTIONS.SET_THEME: {\r\n      return {\r\n        ...state,\r\n        theme: action.theme\r\n      };\r\n    }\r\n    case ACTIONS.SET_THEMES: {\r\n      return {\r\n        ...state,\r\n        themes: action.themes\r\n      };\r\n    }\r\n    default: {\r\n      return {\r\n        ...state\r\n      };\r\n    }\r\n  } \r\n};\r\n","import { combineReducers } from \"redux\";\r\nimport data from './reducers/DataReducer';\r\n\r\nconst rootReducer = combineReducers({\r\n  data\r\n});\r\n\r\nexport default rootReducer;\r\n","import { createStore, applyMiddleware } from \"redux\";\r\n\r\nimport thunkMiddleware from \"redux-thunk\";\r\n\r\nimport rootReducer from \"./rootreducer\";\r\n\r\nconst middleware = applyMiddleware(thunkMiddleware);\r\n\r\nconst Store = createStore(rootReducer, middleware);\r\n\r\nexport default Store;\r\n","export const envi = ()=>{\r\n    const dev = (window.location.hostname === \"localhost\" || window.location.hostname === \"127.0.0.1\");\r\n    const status = (()=>{return `Running ${dev?'local':'server'}`})()\r\n    const printstatus = ()=>{\r\n        console.log(status);\r\n    }\r\n\r\n    if (dev){\r\n        document.title = \" (local) \" + document.title;\r\n    }\r\n    \r\n    return {\r\n        dev,\r\n        status,\r\n        printstatus\r\n    }   \r\n}\r\n\r\nexport default envi","import sanityClient from '@sanity/client'\r\nimport envi from './environment'\r\nimport {settings} from './connector_settings.json'\r\nimport { ACTIONS as DATA_ACTIONS } from \"../reducers/DataReducer\"\r\n// import toast from '../services/toast'\r\nimport imageUrlBuilder from '@sanity/image-url'\r\nimport { io } from \"socket.io-client\";\r\n\r\nconst prevFetched = {};\r\n\r\nexport const client = (dispatch, socket)=>{\r\n    const environment = envi();\r\n    let _ = settings;\r\n    let news = [];\r\n    // const sc = sanityClient({\r\n    //     projectId: _.projectId,\r\n    //     dataset: _.dataset,\r\n    //     token: _.token, // or leave blank to be anonymous user\r\n    //     ignoreBrowserTokenWarning: true,\r\n    //     useCdn: false\r\n    // })\r\n\r\n    // kick it\r\n    if (window.location.hostname === \"localhost\" || window.location.hostname === \"127.0.0.1\"){\r\n        socket = io(\"http://localhost:2200/\", { transports: [\"websocket\"] });\r\n    } else {\r\n        socket= io();\r\n    }\r\n    dispatch({type: DATA_ACTIONS.SET_SOCKET, socket});\r\n\r\n    socket.on(\"/gamesettings\", (gameSettings)=>{\r\n        dispatch({type: DATA_ACTIONS.SET_GAME_SETTINGS, gameSettings});\r\n      })\r\n    \r\n    socket.on(\"/sensortypes\", (sensorTypes)=>{\r\n        dispatch({type: DATA_ACTIONS.SET_SENSOR_TYPES, sensorTypes});\r\n    })\r\n\r\n    // socket.on(\"/updateSensors\", (plantClusters)=>{\r\n    //     dispatch({type: DATA_ACTIONS.SET_PLANT_CLUSTERS, plantClusters})\r\n    // });\r\n\r\n    // const fetch = (query)=>{\r\n    //     return new Promise((resolve, reject)=>{\r\n    //         if (prevFetched[query]){\r\n    //             if (environment.dev){\r\n    //                 console.log(\"reused cached query\");\r\n    //             }\r\n    //             resolve(prevFetched[query]);\r\n    //         } else {\r\n    //             sc.fetch(query)\r\n    //             .then((data)=>{\r\n    //                 prevFetched[query] = data;\r\n    //                 resolve(data);\r\n    //             }).catch(reject);\r\n    //         }\r\n    //     })\r\n    // }\r\n\r\n    // const builder = imageUrlBuilder(sc)\r\n\r\n    // const squareImage = (url, width)=>{\r\n    //     return builder.image(url).width(width).height(width).url();\r\n    // }\r\n\r\n    \r\n    // if (environment.dev){\r\n    //     environment.printstatus()\r\n    // } \r\n    // // title, description, \r\n    // fetch(\"*[_type == 'biomoddnews']{title, description, images[]{title, description, 'image':image.asset->url}} | order(_createdAt desc)\").then((news)=>{\r\n    //     dispatch({ type: DATA_ACTIONS.SET_NEWS, news});\r\n    // })\r\n\r\n    // fetch(\"*[_type == 'biomoddevent']{description, title, moment, available}|order(moment asc)\").then((events)=>{\r\n    //     dispatch({type: DATA_ACTIONS.SET_EVENTS, events});\r\n    // })\r\n\r\n    // fetch(\"*[_type == 'faq']{title, description}\").then((faqs)=>{\r\n    //     dispatch({type: DATA_ACTIONS.SET_FAQS, faqs})\r\n    // })\r\n\r\n    // return {\r\n    //     fetch,\r\n    //     environment,\r\n    //     squareImage\r\n    // }\r\n\r\n    return {\r\n        socket\r\n    }\r\n}\r\n\r\n\r\n\r\nexport default client;\r\n\r\n","import React, {useState, useEffect} from 'react';\r\nimport { useSelector } from \"react-redux\";\r\n\r\n// const Input = ({label, value, setValue})=>{\r\n//     const theme = useSelector(state => state.data.theme);\r\n//     const [name, setName] = useState(\"\");\r\n    \r\n//     const handleSubmit = (evt) => {\r\n//         evt.preventDefault();\r\n//         alert(`Submitting Name ${name}`)\r\n//     }\r\n\r\n//     if (!theme){\r\n//         return null;\r\n//     } else {\r\n\r\n//     return (\r\n//       <form onSubmit={handleSubmit}>\r\n//         <label>\r\n//             <theme.Text>\r\n//                 {label}&nbsp;&nbsp;\r\n//           </theme.Text>\r\n//           <input\r\n//             type=\"text\"\r\n//             value={value}\r\n//             onChange={e => setValue(e.target.value)}\r\n//           />\r\n//         </label>\r\n//       </form>\r\n//     );\r\n//     }\r\n// }\r\n\r\nexport function Input({label, setValue}) {\r\n    const [name, setName] = useState(\"\");\r\n    \r\n    const handleSubmit = (evt) => {\r\n        evt.preventDefault();\r\n        setValue(name);\r\n    }\r\n    return (\r\n      <form onSubmit={handleSubmit}>\r\n        <label>\r\n            <code>\r\n                {label}&nbsp;\r\n          </code>\r\n          <input\r\n            type=\"text\"\r\n            value={name}\r\n            onChange={e => setName(e.target.value)}\r\n          />\r\n        </label>\r\n        &nbsp;\r\n        <input type=\"submit\" value=\"Submit\" />\r\n      </form>\r\n    );\r\n  }\r\n\r\nexport default Input;","import React, {useState, useEffect} from 'react';\r\nimport { useSelector } from \"react-redux\";\r\nimport { Col, Row} from '../theme'\r\nimport { NavLink } from 'react-router-dom';\r\nimport Logo from '../assets/logo.svg'\r\n\r\n\r\nconst Nav = ()=>{\r\n    const theme = useSelector(state => state.data.theme);\r\n    \r\n\r\n    if (!theme ){\r\n        return null;\r\n    }\r\n\r\n    \r\n\r\n    return <Row center=\"xs\">\r\n\r\n\r\n        <Col xs={8} sm={2}>\r\n            <NavLink to=\"/\">\r\n            <img src={Logo} style={{width: \"100%\"}}/>\r\n            </NavLink>\r\n        </Col>\r\n        <Col xs={12} sm={10}>\r\n            <br/><br/>\r\n            <NavLink to=\"/\">\r\n            <theme.Text >\r\n              <span style={{color: \"white\", fontSize: \"4em\", fontWeight: \"bold\"}}>\r\n                  &nbsp;BIOMODD [BRG<sup>13</sup>]\r\n              </span>\r\n                \r\n            </theme.Text>\r\n            </NavLink>\r\n            <theme.Container>\r\n            <theme.Text>\r\n                <NavLink to=\"/gamelegacy\" style={{color: \"white\"}}>\r\n                &nbsp;&nbsp;&nbsp;-> TEST GAME (legacy)\r\n                </NavLink>\r\n                <NavLink to=\"/server\" style={{color: \"white\"}}>\r\n                &nbsp;&nbsp;&nbsp;-> TEST SERVER\r\n                </NavLink>\r\n                <NavLink to=\"/\" style={{color: \"white\"}}>\r\n                &nbsp;&nbsp;&nbsp;-> HOME\r\n                </NavLink>\r\n            </theme.Text>\r\n            </theme.Container>\r\n            \r\n\r\n        </Col>\r\n\r\n       \r\n    </Row>\r\n\r\n}\r\n\r\nexport default Nav;\r\n\r\n\r\n{/* <theme.Container>\r\n            <br/><br/>\r\n            <theme.Wrapped>\r\n              <theme.Container>\r\n                <theme.Title>\r\n                    GoTo\r\n                </theme.Title>\r\n                <theme.Text>\r\n                  <ul>\r\n                    <li onClick={getScroller(newsref)}>\r\n                      -> news\r\n                    </li>\r\n                    <li onClick={getScroller(gameref)}>\r\n                      -> game\r\n                    </li>\r\n                    <li onClick={getScroller(restref)}>\r\n                      -> store and retrieve data (RESTful)\r\n                    </li>\r\n                    <li onClick={getScroller(socketref)}>\r\n                      -> store and retrieve data (WEBSOCKET)\r\n                    </li>\r\n                  </ul>\r\n                </theme.Text>\r\n              </theme.Container>\r\n            </theme.Wrapped>\r\n          </theme.Container> */}","// ===============================\r\n//      A U X\r\n// ===============================\r\nexport const getPointOnCircle = (p5, centrum, offset, division, section)=>{\r\n    let angle = ((2 * Math.PI) / division) * section;\r\n    let pos = p5.createVector(Math.cos(angle), Math.sin(angle));\r\n    pos.mult(offset);\r\n    pos.add(centrum);\r\n    return pos;\r\n}\r\n\r\n\r\n\r\nfunction sqr(x) { return x * x }\r\nfunction dist2(v, w) { return sqr(v.x - w.x) + sqr(v.y - w.y) }\r\nfunction distToSegmentSquared(p, v, w) {\r\n    var l2 = dist2(v, w);\r\n    if (l2 == 0) return dist2(p, v);\r\n    var t = ((p.x - v.x) * (w.x - v.x) + (p.y - v.y) * (w.y - v.y)) / l2;\r\n    t = Math.max(0, Math.min(1, t));\r\n    return dist2(p, { x: v.x + t * (w.x - v.x),\r\n        y: v.y + t * (w.y - v.y) });\r\n}\r\nexport const distToSegment = (p, v, w) =>{ return Math.sqrt(distToSegmentSquared(p, v, w)); }\r\n\r\n\r\n\r\n\r\nconst eps = 0.0000001;\r\nconst between = (a, b, c) => a - eps <= b && b <= c + eps;\r\n\r\nexport const segment_intersection = (x1, y1, x2,y2, x3, y3, x4, y4) => {\r\n\r\n\r\n    var x = ((x1*y2-y1*x2)*(x3-x4)-(x1-x2)*(x3*y4-y3*x4)) /\r\n        ((x1-x2)*(y3-y4)-(y1-y2)*(x3-x4));\r\n\r\n    var y = ((x1*y2-y1*x2)*(y3-y4)-(y1-y2)*(x3*y4-y3*x4)) /\r\n        ((x1-x2)*(y3-y4)-(y1-y2)*(x3-x4));\r\n\r\n    if(\r\n        (isNaN(x) || isNaN(y)) ||\r\n        (x1>=x2 && !between(x2, x, x1) || !between(x1, x, x2)) ||\r\n        (y1>=y2 && !between(y2, y, y1) || !between(y1, y, y2)) ||\r\n        (x3>=x4 && !between(x4, x, x3) || !between(x3, x, x4)) ||\r\n        (y3>=y4 && !between(y4, y, y3) || !between(y3, y, y4))\r\n    ) {\r\n        return false;\r\n    }\r\n\r\n    return true; //{x: x, y: y};\r\n\r\n};\r\n\r\n\r\n\r\nexport const mouseV = (p5)=>p5.createVector(p5.mouseX, p5.mouseY);","// ========================================\r\n//      I N T E R A C T I V E  O B J E C T\r\n// ========================================\r\n// an interactive object, that knows when clicked or dragged\r\n// currently assumes it is round\r\n\r\nexport const IO_STATE = Object.freeze({\r\n    UNSELECTED: \"unselected\",\r\n    CLICKED: \"clicked\",\r\n    HOVERING: \"hovering\",\r\n    DRAGGED: \"dragged\"\r\n})\r\n\r\nexport class InteractiveObject {\r\n    \r\n    constructor(location, size){\r\n        this.location = location;\r\n        this.size = size;\r\n        this.state = IO_STATE.UNSELECTED;\r\n        this.changed = false;\r\n        this.easing = 0.05;\r\n    }\r\n\r\n    easer = (target, value)=>{\r\n        const dx = target - value;\r\n        value += dx * this.easing;\r\n        return value;\r\n    }\r\n\r\n    checkChanged = ()=>{\r\n        const rv = this.changed;\r\n        this.changed = false;\r\n        return rv;\r\n    }\r\n\r\n    isOver(loc){\r\n        return loc.dist(this.location) < this.size/2;\r\n    }\r\n\r\n    isCurrentOver(p5){\r\n        return this.isOver(p5.createVector(p5.mouseX, p5.mouseY));\r\n    }\r\n\r\n    mousePressed(p5){\r\n        if (this.isCurrentOver(p5)){\r\n            this.state = IO_STATE.CLICKED;\r\n        }\r\n    }\r\n\r\n    mouseReleased(p5){\r\n        this.state = IO_STATE.UNSELECTED;\r\n        this.mouseMoved(p5);\r\n        this.changed = true;\r\n    }\r\n\r\n    mouseDragged(p5){\r\n        if (this.state !== IO_STATE.UNSELECTED){\r\n            this.state = IO_STATE.DRAGGED;\r\n        }   \r\n        this.changed = true;\r\n    }\r\n\r\n    mouseMoved(p5){\r\n        if (this.state === IO_STATE.UNSELECTED && this.isCurrentOver(p5)){\r\n            this.state = IO_STATE.HOVERING;\r\n        } else if (this.state === IO_STATE.HOVERING && !this.isCurrentOver(p5)){\r\n            this.state = IO_STATE.UNSELECTED;\r\n        }\r\n    }\r\n}","\r\n/* * * * * * * * * * * * * * * * * * * * * * * * \r\n\r\n                  F L O W E R\r\n\r\n * * * * * * * * * * * * * * * * * * * * * * * *\r\n\r\nDraws a full flower with a specified number of segments and a stroke color:\r\n\r\nMain segments: the outer ring of segments (biggest)\r\nSecondary segments: the middle ring of segments (bit smaller)\r\nTertiary segments: inner ring of segments (smallest)\r\nStroke color: a P5 color\r\n\r\nCall the function setColor(c) to change the color of the flower\r\n\r\nYou can experiment with the random ranges in the constructor to change the scale and number \r\nof segments in the three types of segments. There is a bit of randomness built in to make \r\nthe flower appear a bit different even with the same number of segments.\r\n\r\nThe different segments have a gentle rotation. Each ring of segments rotates at a slightly different speed\r\nCall the function setRotationFactor(f) to make the flower temporarily rotate faster. The function\r\nwill apply the faster rotation and then gradually decrease the rotation speed again, \r\nwhich can be useful for an animation effect like when a light beam hits it.\r\n\r\n*/\r\n\r\nexport class Flower {\r\n    constructor(mainSegments, secondarySegments, tertiarySegments, strokeColor, p5) {\r\n        this.rotationFactor = 1;\r\n        this.p5 = p5;\r\n        this.mainSegments = [];\r\n        this.secondarySegments = [];\r\n        this.tertiarySegments = [];\r\n\r\n        let mainSegmentScale = this.p5.random(2,3);\r\n        let mainStartpoint = this.p5.random(0, (Math.PI*2)/mainSegments);\r\n        let secondarySegmentscale = this.p5.random(1, 2);\r\n        let secondaryStartpoint = this.p5.random(0, (Math.PI*2)/secondarySegments);\r\n        let tertiarySegmentscale = this.p5.random(3,5);\r\n        let tertiaryStartpoint = this.p5.random(0, (Math.PI*2)/tertiarySegments);\r\n\r\n        this.strokeColor = strokeColor;\r\n\r\n        // main segments\r\n        for(let i=0; i<mainSegments; i++) {\r\n            let s1 = new BigSpine(mainSegmentScale, this.strokeColor, p5);\r\n            s1.setstrokeWeight(1/mainSegmentScale);\r\n            s1.setRotation(mainStartpoint+(i*((Math.PI*2)/mainSegments)));\r\n            s1.enableRotation();\r\n            s1.setRotationSpeed(0.001);\r\n\r\n            let s2 = new BigSpine(mainSegmentScale, this.strokeColor, p5);\r\n            s2.setstrokeWeight(1/mainSegmentScale);\r\n            s2.setRotation(mainStartpoint-(i*((Math.PI*2)/mainSegments)));\r\n            s2.flipVertical();\r\n            s2.enableRotation();\r\n            s2.setRotationSpeed(0.001);\r\n\r\n            this.mainSegments .push(s1);\r\n            this.mainSegments .push(s2);\r\n        }\r\n\r\n        for(let i=0; i<secondarySegments; i++) {\r\n            let s1 = new BigSpine(secondarySegmentscale, this.strokeColor, p5);\r\n            s1.setstrokeWeight(1/secondarySegmentscale);\r\n            s1.setRotation(secondaryStartpoint+(i*((Math.PI*2)/secondarySegments)));\r\n            s1.enableRotation();\r\n            s1.setRotationSpeed(0.0015);\r\n\r\n            let s2 = new BigSpine(secondarySegmentscale, this.strokeColor, p5);\r\n            s2.setstrokeWeight(1/secondarySegmentscale);\r\n            s2.flipVertical();\r\n            s2.setRotation(secondaryStartpoint+(i*((Math.PI*2)/secondarySegments)));\r\n            s2.enableRotation();\r\n            s2.setRotationSpeed(0.0015);\r\n\r\n            this.secondarySegments .push(s1);\r\n            this.secondarySegments .push(s2);\r\n        }\r\n\r\n        for(let i=0; i<tertiarySegments; i++) {\r\n            let s1 = new SmallSpine(tertiarySegmentscale, this.strokeColor, p5);\r\n            s1.setstrokeWeight(1/tertiarySegmentscale);\r\n            s1.setRotation(tertiaryStartpoint+(i*((Math.PI*2)/tertiarySegments)));\r\n            s1.enableRotation();\r\n            s1.setRotationSpeed(0.0025);\r\n\r\n            let s2 = new SmallSpine(tertiarySegmentscale, this.strokeColor, p5);\r\n            s2.setstrokeWeight(1/tertiarySegmentscale);\r\n            s2.setRotation(tertiaryStartpoint+(i*((Math.PI*2)/tertiarySegments)));\r\n            s2.flipVertical();\r\n            s2.enableRotation();\r\n            s2.setRotationSpeed(0.0025);\r\n\r\n            this.tertiarySegments .push(s1);\r\n            this.tertiarySegments .push(s2);\r\n        }\r\n    }\r\n\r\n    draw() {\r\n\r\n        // main\r\n        for(let i=0; i<this.mainSegments.length; i++) {\r\n            this.p5.push();\r\n            this.mainSegments[i].setRotationFactor(this.rotationFactor);\r\n            this.mainSegments[i].draw();\r\n            this.p5.pop();\r\n        }\r\n\r\n        // secondary\r\n        for(let i=0; i<this.secondarySegments.length; i++) {\r\n            this.p5.push();\r\n            this.secondarySegments[i].setRotationFactor(this.rotationFactor);\r\n            this.secondarySegments[i].draw();\r\n            this.p5.pop();\r\n        }\r\n\r\n        // tertiary\r\n        for(let i=0; i<this.tertiarySegments.length; i++) {\r\n            this.p5.push();\r\n            this.tertiarySegments[i].setRotationFactor(this.rotationFactor);\r\n            this.tertiarySegments[i].draw();\r\n            this.p5.pop();\r\n        }\r\n\r\n        // rotation factor\r\n        if(this.rotationFactor>1) {\r\n            this.rotationFactor--;\r\n        }\r\n    }\r\n\r\n    setRotationFactor(f) {\r\n        this.rotationFactor = f;\r\n    }\r\n\r\n    setColor(c) {\r\n        this.strokeColor = c;\r\n\r\n        // loop through all segments to set color:\r\n        for(let i=0; i<this.mainSegments.length; i++) {\r\n            this.mainSegments[i].setColor(this.strokeColor);\r\n        }\r\n\r\n        for(let i=0; i<this.secondarySegments.length; i++) {\r\n            this.secondarySegments[i].setColor(this.strokeColor);\r\n        }\r\n\r\n        for(let i=0; i<this.tertiarySegments.length; i++) {\r\n            this.tertiarySegments[i].setColor(this.strokeColor);\r\n        }\r\n    }\r\n}\r\n\r\n\r\n// // Describes an individual segment of a flower\r\nclass FlowerSegment {\r\n    constructor(scaleFactor, strokeColor, p5) {\r\n        this.scaleFactor = scaleFactor;\r\n        this.rotation = 0.0;\r\n        this.scale = {x: 1, y: 1};\r\n        this.translation = { x: 0, y: 0 };\r\n        this.branches = [];\r\n        this.branchPoints = [];\r\n        this.strokeWeight = 1;\r\n        this.rotationSpeed = 0;\r\n        this.rotationFactor = 1;\r\n        this.strokeColor = strokeColor;\r\n        this.p5 = p5;\r\n    }\r\n\r\n    setRotation(r) {\r\n        // add some random adjust to the rotation\r\n        let randomAdjust = this.p5.random(-r/40, r/40);\r\n        this.rotation = r + randomAdjust;\r\n    }\r\n\r\n    setTranslation(t) {\r\n        this.translation = t;\r\n    }\r\n\r\n    setstrokeWeight(sw) {\r\n        this.strokeWeight = sw;\r\n    }\r\n\r\n    setColor(c) {\r\n        this.strokeColor = c;\r\n    }\r\n\r\n    flipHorizontal() {\r\n        this.scale.x = -this.scale.x;\r\n    }\r\n\r\n    flipVertical() {\r\n        this.scale.y = -this.scale.y;\r\n    }\r\n\r\n    enableRotation() {\r\n        this.rotate = true;\r\n    }\r\n\r\n    setRotationSpeed(r) {\r\n        this.rotationSpeed = r;\r\n    }\r\n\r\n    setRotationFactor(f) {\r\n        this.rotationFactor = f;\r\n    }\r\n\r\n}\r\n\r\n// // Describes a big spine and its branches and leaves\r\nclass BigSpine extends   FlowerSegment{\r\n    constructor(scaleFactor, strokeColor, p5) {\r\n        super(scaleFactor, strokeColor, p5);\r\n\r\n        // branch points\r\n        this.branchPoints = [{x: 6, y: 70, r: -0.3}, {x: 5.8, y: 40, r: -0.8}, {x: -20.392, y: 7.463, r: -1.65}];\r\n\r\n        for(let i=0; i<this.branchPoints.length; i++) {\r\n            // either pick a leaf or a smaller spine\r\n            let seed = Math.random()*10;\r\n            if(seed<=6) {\r\n                // branch a smaller spine\r\n                let newBranch = new SmallSpine(1, this.strokeColor, this.p5);\r\n                newBranch.setTranslation(this.branchPoints[i]);\r\n                newBranch.setRotation(this.branchPoints[i].r);\r\n                newBranch.setstrokeWeight(1/this.scaleFactor);\r\n                this.branches.push(newBranch);\r\n\r\n            } else {\r\n                // branch a leaf\r\n                let newLeaf = new Leaf(1.5, this.strokeColor, this.p5);\r\n                newLeaf.setstrokeWeight(1/this.scaleFactor);\r\n                newLeaf.setTranslation(this.branchPoints[i]);\r\n                newLeaf.setRotation(this.branchPoints[i].r);\r\n                this.branches.push(newLeaf);\r\n            }\r\n        }\r\n    }\r\n\r\n    setColor(c) {\r\n        this.strokeColor = c;\r\n\r\n        for(let i=0; i<this.branches.length; i++) {\r\n            this.branches[i].setColor(c);\r\n        }\r\n    }\r\n\r\n    draw() {\r\n        this.p5.push();\r\n        // adjust rotation\r\n        this.p5.rotate(this.rotation);\r\n        // adjust size\r\n        this.p5.scale(this.scaleFactor);\r\n        // this sets the orientation\r\n        this.p5.scale(this.scale.x, this.scale.y);\r\n        // move to center\r\n        this.p5.translate(this.translation.x, this.translation.y);\r\n        // set the stroke\r\n        this.p5.strokeWeight(this.strokeWeight);\r\n        this.p5.stroke(this.strokeColor);\r\n        this.p5.noFill();\r\n\r\n        // SVG coordinates\r\n        this.p5.translate(0,-83.565);\r\n        // start drawing the Bigspine segment\r\n        this.p5.bezier(0, 83.565, 15.384, 56.919, 6.254, 22.847, -20.392, 7.463);\r\n        this.p5.bezier(-20.392, 7.463, -28.86, 2.574, -38.467, 0, -48.247, 0);\r\n        this.p5.bezier(0, 84.856, 10.564, 68.225, 11.09, 48.082, 3.162, 31.532);\r\n        this.p5.bezier(3.162, 31.532, -1.138, 22.558, -7.923, 14.64, -16.942, 8.911);\r\n        this.p5.bezier(-16.942, 8.911, -26.28, 2.979, -37.189, 0, -48.247, 0);\r\n        \r\n        // add some visualization for debugging purposes: \r\n        if(this.debug) {\r\n            // marker for start point\r\n            this.p5.circle(0, 83.565, 3);\r\n            \r\n            // branch points\r\n            for(let i=0; i<this.branchPoints.length; i++) {\r\n                let bp = this.branchPoints[i];\r\n                this.p5.circle(bp.x, bp.y, 3);\r\n            }\r\n            // marker for end point\r\n            this.p5.circle(-48.247, 0, 3);\r\n        }\r\n        \r\n        for(let i=0; i<this.branches.length; i++) {\r\n            this.branches[i].draw();\r\n        }\r\n\r\n        if(this.rotate) {\r\n            this.rotation += this.rotationSpeed * this.rotationFactor;\r\n        }\r\n        this.p5.pop();\r\n    }\r\n}\r\n\r\n\r\n// // draw a smaller, slightly less curvy segment, with leaves\r\nclass SmallSpine extends  FlowerSegment {\r\n    constructor(scaleFactor, strokeColor, p5) {\r\n        super(scaleFactor, strokeColor, p5);\r\n\r\n        // branch points\r\n        this.branches = [];\r\n        this.branchPoints = [{x: 10, y: -9.2, r: -0.4}];\r\n\r\n        for(let i=0; i<this.branchPoints.length; i++) {\r\n            // 50% chance to spawn a leaf\r\n            let seed = Math.random()*10;\r\n            if(seed<=5) {\r\n                // branch a smaller spine\r\n                let newLeaf = new Leaf(1, this.strokeColor, this.p5);\r\n                newLeaf.setstrokeWeight(1/this.scaleFactor*this.strokeWeight);\r\n                newLeaf.setTranslation(this.branchPoints[i]);\r\n                newLeaf.setRotation(this.branchPoints[i].r);\r\n                this.branches.push(newLeaf);\r\n\r\n            }\r\n        }\r\n    }\r\n\r\n    setColor(c) {\r\n        this.strokeColor = c;\r\n\r\n        for(let i=0; i<this.branches.length; i++) {\r\n            this.branches[i].setColor(c);\r\n        }\r\n    }\r\n\r\n    draw() {\r\n        this.p5.push();\r\n        this.p5.translate(this.translation.x, this.translation.y);\r\n        this.p5.rotate(this.rotation);\r\n        this.p5.scale(this.scale.x, this.scale.y);\r\n        this.p5.scale(this.scaleFactor);\r\n        this.p5.stroke(this.strokeColor);\r\n        this.p5.strokeWeight(this.strokeWeight);\r\n        this.p5.noFill();\r\n        \r\n        this.p5.scale(1, 1);\r\n\r\n        this.p5.translate(0.921, 3.212);\r\n        this.p5.bezier(-0.921, -3.212, 4.297, -7.26, 11.593, -7.26, 16.81, -3.212);\r\n        this.p5.translate(-0.65, 5);\r\n        this.p5.rotate(-Math.PI/18)\r\n        this.p5.bezier(-1.692, -5.037, 4.072, -10.174, 12.773, -10.174, 18.537, -5.037);\r\n\r\n        if(this.debug) {\r\n            // marker for start point\r\n            this.p5.circle(1.15, -8.15, 3);\r\n\r\n            // branchpoints\r\n            for(let i=0; i<this.branchPoints.length; i++) {\r\n                let bp = this.branchPoints[i];\r\n                this.p5.circle(bp.x, bp.y, 3);\r\n            }\r\n        }\r\n\r\n        \r\n        for(let i=0; i<this.branches.length; i++) {\r\n            this.branches[i].draw();\r\n        }\r\n\r\n        if(this.rotate) {\r\n            this.rotation += this.rotationSpeed * this.rotationFactor;\r\n        }\r\n        \r\n        this.p5.pop();\r\n    }\r\n}\r\n\r\n\r\n// // draws a leaf\r\nclass Leaf extends  FlowerSegment {\r\n    constructor(scaleFactor, strokeColor, p5) {\r\n        super(scaleFactor, strokeColor, p5);\r\n    }\r\n\r\n    draw() {\r\n        this.p5.push();\r\n        this.p5.translate(this.translation.x, this.translation.y);\r\n        this.p5.rotate(this.rotation);\r\n        this.p5.scale(this.scale.x, this.scale.y);\r\n        this.p5.scale(this.scaleFactor);\r\n        this.p5.translate(1.01, 2.246);\r\n        this.p5.stroke(this.strokeColor);\r\n        //this.p5.strokeWeight(this.strokeWeight);\r\n        this.p5.noFill();\r\n\r\n        // leaf middle line\r\n        this.p5.bezier(-1.01, -2.246, 0.912, -3.034, 3.068, -3.034, 4.99, -2.246);\r\n        \r\n        // add some visualization for debugging purposes: \r\n        if(this.debug) {\r\n            // marker for start point\r\n            this.p5.circle(-1.01, -2.246, 3);\r\n        }\r\n        \r\n        // adjust leaf position and orientation\r\n        this.p5.scale(1, -1);\r\n        this.p5.rotate(-Math.PI/3.6);\r\n        this.p5.translate(-1.25, 5.35);\r\n        \r\n        // first leaf half\r\n        this.p5.bezier(0, -2.368, 0.72, -2.309, 1.394, -1.988, 1.893, -1.466);\r\n        this.p5.bezier(1.893, -1.466, 2.127, -1.22, 2.3, -0.921, 2.395, -0.596);\r\n        this.p5.bezier(2.395, -0.596, 2.494, -0.363, 2.649, -0.159, 2.845, 0);\r\n        \r\n        // second half\r\n        this.p5.bezier(0, -2.368, 0.008, -1.544, 0.467, -0.791, 1.194, -0.403);\r\n        this.p5.bezier(1.194, -0.403, 1.446, -0.27, 1.726, -0.198, 2.01, -0.195);\r\n        this.p5.bezier(2.01, -0.195, 2.299, -0.191, 2.584, -0.125, 2.845, 0);\r\n        this.p5.pop();\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n","import {IO_STATE, InteractiveObject} from './interactiveObject.js'\r\n\r\nimport {distToSegment} from './auxi'\r\nimport {Flower as FlowerGraphic} from './graphics';\r\n\r\n// ===============================\r\n//      P L A N T\r\n// ===============================\r\n// Them plants\r\n\r\nclass Plant extends InteractiveObject {\r\n    constructor({location, size, color, alternativeColor, onClick, p5, grid, collisionColor}){\r\n        super(location, size);\r\n        this.color = color;\r\n        this.alternativeColor = alternativeColor;\r\n        this.collisionColor = collisionColor;\r\n        this.colorplaceholder = color;\r\n        this.onClick = onClick;\r\n        this.currentColors = {\r\n            red: false,\r\n            green: false,\r\n            blue: false\r\n        };\r\n\r\n        this.flower = new FlowerGraphic(Math.ceil(p5.random(4,6)), Math.ceil(p5.random(2,4)), Math.ceil(p5.random(5, 8)), p5.color(p5.random(75, 128), p5.random(75, 128), p5.random(75, 128)), p5);\r\n        this.coords = grid.nearestGridPoint({ x: p5.random(0, 1), y: p5.random(0, 1)});\r\n    }\r\n\r\n    detectCollision(lights){\r\n        let col = false;\r\n        this.currenctColors = {\r\n            red: false,\r\n            green: false,\r\n            blue: false\r\n        };\r\n        for (let light of lights.values()) {\r\n            for (let j = 0; j < light.beam.segments.length; j++) {\r\n                var segment = light.beam.segments[j];\r\n\r\n                let line_v = {x: segment.p1_x, y: segment.p1_y};\r\n\r\n                let line_w = {x: segment.p2_x, y: segment.p2_y};\r\n\r\n                let point =  {x: this.location.x, y: this.location.y};\r\n                if (distToSegment(point, line_v, line_w) < this.size/2){   // collision\r\n                    col = true;\r\n                    this.currentColors[light.color] = true;\r\n                }\r\n            }\r\n        }\r\n        if (col) {\r\n            this.color = this.collisionColor;\r\n        } else {\r\n            this.color = this.colorplaceholder\r\n        }\r\n    }\r\n    draw(p5){\r\n        p5.push();\r\n        p5.translate(this.location.x, this.location.y);\r\n        this.flower.draw();\r\n\r\n        p5.pop();\r\n\r\n        p5.noStroke();\r\n        if (this.state === IO_STATE.UNSELECTED || this.state === IO_STATE.HOVERING){\r\n            p5.fill(this.color);\r\n        } else {\r\n            if (this.state === IO_STATE.CLICKED ){\r\n                this.onClick();\r\n            }\r\n            p5.fill(this.alternativeColor);\r\n        }\r\n\r\n        let size = this.size;\r\n        if (this.state === IO_STATE.HOVERING){\r\n            size+=Math.sin(p5.millis())*5;\r\n        }\r\n        \r\n        p5.circle(this.location.x, this.location.y, size);\r\n    }\r\n}\r\n\r\nexport default Plant;","import {IO_STATE, InteractiveObject} from './interactiveObject'\r\nimport {mouseV} from './auxi'\r\n\r\n// the handle that allows for the rotation of the light\r\nclass Handle extends InteractiveObject {\r\n    constructor (location, size, circleSize, direction, color, strokeWeight){\r\n        super(location, size);\r\n        this.color = color;\r\n        this.strokeWeight = strokeWeight;\r\n\r\n        this.direction = direction;\r\n        this.circleSize = circleSize;\r\n        this.target = this.direction;\r\n    }\r\n\r\n    rotate(p5) {\r\n        // this should just update the direction, the rest will be handled by draw\r\n        let mousePos = mouseV(p5);\r\n        const diff = p5.createVector(0,0).set(this.location).sub(mousePos);\r\n        this.direction = p5.createVector(-diff.normalize().x, -diff.normalize().y);\r\n        this.target = this.direction;\r\n    }\r\n\r\n    // return the direction\r\n    // the object calling this might do something with the direction (eg: beam inverses the direction)\r\n    getDirection(p5) {\r\n        return this.direction;\r\n    }\r\n\r\n    // overwrite the function to detect hover based on the position of the handle\r\n    isOver(loc){\r\n        return  loc && this.handlePosition && loc.dist(this.handlePosition) < this.size/2;\r\n    }\r\n\r\n\r\n    draw(p5){\r\n        if(this.state === IO_STATE.DRAGGED){\r\n            this.rotate(p5);\r\n        }\r\n\r\n        if (this.target!==this.direction){\r\n            this.direction.x = this.easer(this.target.x, this.direction.x);\r\n            this.direction.y = this.easer(this.target.y, this.direction.y);\r\n        }\r\n\r\n        p5.strokeWeight(this.strokeWeight);\r\n        // draw the cirlce on which the handle moves\r\n        p5.noFill();\r\n        p5.stroke(this.color);\r\n        p5.circle(this.location.x, this.location.y, this.circleSize);\r\n        \r\n        let handleOffset = p5.createVector(this.direction.x, this.direction.y);\r\n        handleOffset.setMag(this.circleSize/2);\r\n\r\n        // calculate the handle position\r\n        this.handlePosition = p5.createVector(this.location.x, this.location.y).add(handleOffset);\r\n\r\n        // offset the handle in the direction needed:\r\n        // draw the handle\r\n        p5.noStroke();\r\n        p5.fill(this.color);\r\n        p5.circle(this.handlePosition.x, this.handlePosition.y, this.state===IO_STATE.UNSELECTED?this.size:this.size*1.2);\r\n    }\r\n\r\n}\r\n\r\nexport default Handle;\r\n","// /* * * * * * * * * * * * * * * * * * * * * * * * \r\n\r\n//                   L I G H T\r\n\r\n//  * * * * * * * * * * * * * * * * * * * * * * * *\r\n\r\n//     Draws the graphics for the light in a color c\r\n// */\r\n\r\nexport class Light {\r\n    constructor(scaleFactor, color, p5) {\r\n        this.scaleFactor = scaleFactor;\r\n        this.strokeColor = color;\r\n        this.strokeWeight = 1/scaleFactor;\r\n        this.debug = false;\r\n        this.p5 = p5;\r\n    }\r\n\r\n    draw() {\r\n        this.p5.push();\r\n        //this.p5.translate(width/2, height/2);\r\n        this.p5.stroke(this.strokeColor);\r\n        this.p5.strokeWeight(this.strokeWeight);\r\n        this.p5.scale(this.scaleFactor);\r\n        \r\n        // triangle\r\n        this.p5.push();\r\n        this.p5.translate(0, 10.5);\r\n        this.p5.line(0, -31.341, -18.1, -0.008);\r\n        this.p5.line(-18.1, -0.008, 18.085, 0);\r\n        this.p5.line(18.085,0, 0,-31.341);\r\n        this.p5.pop();\r\n\r\n        // triangle\r\n        this.p5.push();\r\n        this.p5.translate(18.2, 21);\r\n        this.p5.line(0, -31.326, -18.099, 0.007);\r\n        this.p5.line(-18.099, 0.007, -36.185, -31.333);\r\n        this.p5.line(-36.185, -31.333, 0,-31.326);\r\n        this.p5.pop();\r\n\r\n        // line\r\n        this.p5.push();\r\n        this.p5.rotate(Math.PI/3);\r\n        this.p5.translate(-6, 10.5);\r\n        this.p5.line(-6.033, -10.447, 18.09, -10.447);\r\n        this.p5.pop();\r\n\r\n        // line\r\n        this.p5.push();\r\n        this.p5.rotate(-Math.PI/3);\r\n        this.p5.translate(-6, -10.5);\r\n        this.p5.line(-6.029, 10.444, 18.095, 10.445);\r\n        this.p5.pop();\r\n\r\n        // top filled bit\r\n        this.p5.beginShape();\r\n        this.p5.fill(this.strokeColor);\r\n        this.p5.vertex(0, 0);\r\n        this.p5.vertex(-6, -10.5);\r\n        this.p5.vertex(0, -20.5);\r\n        this.p5.vertex(6, -10.5);\r\n        this.p5.vertex(0, 0);\r\n        this.p5.endShape();\r\n\r\n        // bottom filled bit\r\n        let c = this.p5.color(0);\r\n        this.p5.fill(c);\r\n        this.p5.beginShape();\r\n        this.p5.vertex(0, 0);\r\n        this.p5.vertex(-6, 10.5);\r\n        this.p5.vertex(0, 21);\r\n        this.p5.vertex(6, 10.5);\r\n        this.p5.vertex(0, 0);\r\n        this.p5.endShape();\r\n\r\n        this.p5.noFill();\r\n\r\n        this.p5.push();\r\n        // hexagon\r\n        this.p5.translate(-48.206/2, 0);\r\n        this.p5.line(0, -0.01, 12.066, -20.899);\r\n        this.p5.line(12.066, -20.899, 36.189, -20.894);\r\n        this.p5.line(36.189, -20.894, 48.206, 0.07);\r\n        this.p5.line(48.206, 0.07, 36.18, 20.889);\r\n        this.p5.line(36.18, 20.889, 12.057, 20.884);\r\n        this.p5.line(12.057, 20.884, 0, -0.01);\r\n\r\n        this.p5.pop();\r\n        if(this.debug) {\r\n            this.p5.circle(0, 0, 3);\r\n        }\r\n        this.p5.pop();\r\n\r\n    }\r\n}","import {IO_STATE, InteractiveObject} from './interactiveObject'\r\nimport {mouseV} from './auxi'\r\nimport p5 from \"react-p5\"\r\nimport Handle from \"./handle.js\"\r\nimport { Light as LightGraphic } from './lightGraphic';\r\n\r\n// ===============================\r\n//      L I G H T\r\n// ===============================\r\n\r\n/* \r\n    Contains the objects: \r\n    - Segment:\r\n        Describes a segment on a beam of light, each segment is the result of a reflection off of a mirror\r\n    - Beam\r\n        Functionality of a full beam, this includes the ability to cast a beam in a direction and detect reflections\r\n    - Light:\r\n        Functionality of the full light, containing a beam, handle, and IO\r\n\r\n*/\r\n// The object that emits a beam of light\r\n\r\n\r\n\r\nclass Segment {\r\n    constructor(p1_x, p1_y, p2_x, p2_y, color, mirror){\r\n        this.p1_x = p1_x;\r\n        this.p1_y = p1_y;\r\n        this.p2_x = p2_x;\r\n        this.p2_y = p2_y;\r\n        this.color = color;\r\n        this.mirror = mirror;\r\n    }\r\n}\r\n\r\n\r\nclass Beam {\r\n\r\n    constructor(origin, direction, color, mirrors, p5){\r\n        this.origin = origin;\r\n        this.direction = direction;\r\n        this.color = color;\r\n        this.segments = [];\r\n        this.mirrors = mirrors;\r\n\r\n        // array to keep track of calculated intersection points\r\n        // this is mostly for debugging\r\n        this.intersectPoints = [];\r\n    }\r\n\r\n    setDirection(direction, p5){\r\n        this.direction = direction;\r\n        //this.createSegmentZero(p5);\r\n        //this.segments[0].direction = direction;\r\n    }\r\n\r\n\r\n    /* New function to cast a beam: \r\n    takes point of origin and direction\r\n    this function creates a beam and then checks if it reflects off a mirror (another new function);\r\n    on reflection it will create a segment, add it to the array and cast a new beam from the reflection point\r\n    */\r\n    cast(direction, startPoint, p5, cnt, mirror){\r\n        // draw from point of origin in direction\r\n        const beam = p5.createVector(startPoint).set(direction);\r\n        // set the beam length to the diagonal of the sketch so it always reaches the end of the screen\r\n        beam.setMag(Math.sqrt(Math.pow(p5.width, 2)+Math.pow(p5.height, 2)));\r\n        beam.add(startPoint);\r\n        \r\n        // check beam for reflection (function)\r\n        let reflectionData = this.reflect(startPoint, beam, direction, p5, mirror);\r\n        if(reflectionData!==false) {\r\n            // create segment and add to segments array\r\n            this.segments.push(new Segment(startPoint.x, startPoint.y, reflectionData.x, reflectionData.y, this.color, mirror));\r\n            // cast new beam from reflectionpoint\r\n            let reflectionStart = p5.createVector(reflectionData.x, reflectionData.y);\r\n            // keep counter to stop excessive recursion\r\n            cnt++;\r\n            if(cnt<1000){\r\n                this.cast(reflectionData.direction, reflectionStart, p5, cnt, reflectionData.mirror);\r\n            }\r\n        } else {\r\n            // no reflection has been detected\r\n            this.segments.push(new Segment(startPoint.x, startPoint.y, beam.x, beam.y, this.color, mirror));\r\n        }\r\n    }\r\n\r\n\r\n\r\n    reflect(beamStart, beamEnd, direction, p5, mirror){\r\n\r\n        let intersectionPoints = [];\r\n\r\n        // loop through mirrors\r\n        for(let i=0; i<this.mirrors.length; i++) {\r\n            let mirrorStart = this.mirrors[i].getPoints(p5)[0];\r\n            let mirrorEnd = this.mirrors[i].getPoints(p5)[1];\r\n\r\n            //if(this.mirrors[i].id == \"mirror_0\") console.log(\"x3: \"+ mirrorStart.x + \", y3: \"+ mirrorStart.y + \" | x4: \"+ mirrorEnd.x + \", y4: \"+ mirrorEnd.y);\r\n\r\n            // find the intersection \r\n            // see algorithm at https://en.wikipedia.org/wiki/Line%E2%80%93line_intersection#Given_two_points_on_each_line_segment\r\n            let t = ((mirrorEnd.x - mirrorStart.x) * (beamStart.y - mirrorStart.y) - (mirrorEnd.y - mirrorStart.y) * (beamStart.x - mirrorStart.x)) / ((mirrorEnd.y - mirrorStart.y) * (beamEnd.x - beamStart.x) - (mirrorEnd.x - mirrorStart.x) * (beamEnd.y - beamStart.y));\r\n            let u = ((beamEnd.x - beamStart.x) * (beamStart.y - mirrorStart.y) - (beamEnd.y - beamStart.y) * (beamStart.x - mirrorStart.x)) / ((mirrorEnd.y - mirrorStart.y) * (beamEnd.x - beamStart.x) - (mirrorEnd.x - mirrorStart.x) * (beamEnd.y - beamStart.y));\r\n\r\n            // check t & u to see if intersection is found\r\n            if((t>=0 && t<=1) && (u>=0 && u<=1)) {\r\n                // calculate intersectionpoint x & y, and the distance to the startpoint\r\n                let x = beamStart.x + t * (beamEnd.x - beamStart.x);\r\n                let y = beamStart.y + t * (beamEnd.y - beamStart.y);\r\n                let distance = p5.dist(beamStart.x, beamStart.y, x, y);\r\n                // save for later\r\n                if(this.mirrors[i].ID!=mirror) {\r\n                    let reflectionNormal = this.mirrors[i].getReflection(p5);\r\n                    intersectionPoints.push({x: x, y: y, distance: distance, mirror: this.mirrors[i].ID, direction: 0, reflectionNormal: reflectionNormal});\r\n                }\r\n            }\r\n            \r\n        }\r\n\r\n        // exit if no points have been found\r\n        if(intersectionPoints.length===0) {\r\n            return false;\r\n        } else {\r\n            let intersectionPoint = {};\r\n            // sort the found intersectionpoints by distance\r\n            if(intersectionPoints.length==1) {\r\n                // check if the one hit has a distance of 0\r\n                // this means it is a beam that has already reflected and does not hit anything else other than the starting mirror\r\n                if(intersectionPoints[0].distance==0) {\r\n                    console.log(\"no reflection except itself\");\r\n                    return false;\r\n                } else {\r\n                    intersectionPoint = intersectionPoints[0];\r\n                }\r\n            }  else {\r\n                // sort if there is more than one reflection point\r\n                intersectionPoints.sort((a,b) => (a.distance > b.distance) ? 1 : -1);\r\n\r\n                // check if the first hit has a distance of 0 (hit on the mirror from which a beam starts)\r\n                if(intersectionPoints[0].distance==0) {\r\n                    // skip the hit with distance 0\r\n                    intersectionPoint = intersectionPoints[1];\r\n                } else {\r\n                    intersectionPoint = intersectionPoints[0];\r\n                }\r\n                \r\n            }\r\n            \r\n            // calculate angle using P5 reflect function\r\n            let normDirection = p5.createVector(direction.x, direction.y);\r\n            let reflectVector = p5.createVector(intersectionPoint.reflectionNormal.x, intersectionPoint.reflectionNormal.y);\r\n            normDirection.reflect(reflectVector);\r\n            intersectionPoint.direction = normDirection;\r\n\r\n            // add to array and return\r\n            this.intersectPoints.push(intersectionPoint);\r\n            return intersectionPoint;\r\n        }\r\n        \r\n    }\r\n    \r\n\r\n    draw(p5, direction) {\r\n        \r\n        // reset segments\r\n        this.segments = [];\r\n        // debug: points of intersection\r\n        this.intersectPoints = [];\r\n        // cast first beam (this starts the population of the segments array)\r\n        this.cast(p5.createVector(-direction.x, -direction.y), this.origin, p5, 0, null);\r\n        \r\n        // this debug flag shows or hide the dots that indicate intersection points on the beam\r\n        let debug = true;\r\n        if(debug){\r\n            if(this.intersectPoints.length>0) {\r\n                // console.log(\"Number of intersection points: \"+ this.intersectPoints.length);\r\n                for(let j=0; j<this.intersectPoints.length; j++) {\r\n                    // console.log(this.intersectPoints[j].distance);\r\n                    p5.circle(this.intersectPoints[j].x, this.intersectPoints[j].y, 10);\r\n                }\r\n            }\r\n        }\r\n        \r\n        p5.noFill();\r\n\r\n        // loop through and draw segments\r\n        for (let i=0; i<this.segments.length; i++){\r\n            //console.log(this.segments[i].mirror);\r\n            p5.stroke(this.segments[i].color);\r\n            p5.line(this.segments[i].p1_x, this.segments[i].p1_y, this.segments[i].p2_x, this.segments[i].p2_y);\r\n        }\r\n    }\r\n    \r\n}\r\n\r\n\r\n\r\nclass Light extends InteractiveObject {\r\n    constructor({color, size, location, controlOffset, hide, strokeWeight, player}, mirrors, p5){\r\n        super(location, size);\r\n        this.color = color;\r\n        this.controlOffset = controlOffset;\r\n        this.strokeWeight = strokeWeight;\r\n        this.player = player;\r\n        this.hide = hide;\r\n        this.lightGraphic = new LightGraphic(1, this.color, p5)\r\n         \r\n        // set random direction (direction needs to come from biomodd server) and create handle\r\n        let randDirection = p5.createVector(p5.random(-1, 1), p5.random(-1, 1));\r\n        this.handle = new Handle(this.location, 10, 100, randDirection, this.color, this.strokeWeight);\r\n\r\n        // create the beam with the direction from the handle\r\n        this.beam = new Beam(this.location, p5.createVector(-this.handle.getDirection(p5).x, -this.handle.getDirection(p5).y), color, mirrors, p5);        \r\n    }\r\n\r\n    iPlay(){\r\n        return this.player == this.color;\r\n    }\r\n\r\n    draw(p5){\r\n\r\n        if (this.hide){\r\n            return;\r\n        }\r\n        p5.push();\r\n        p5.translate(this.location.x, this.location.y);\r\n        p5.rotate(-this.handle.direction.angleBetween(p5.createVector(1, 1))-Math.PI/4)\r\n        this.lightGraphic.draw();\r\n        p5.pop();\r\n\r\n        // draw circle for the light\r\n        p5.noStroke();\r\n        if (this.iPlay()){\r\n            p5.fill(this.color);\r\n        } \r\n        // p5.circle(this.location.x, this.location.y, this.size);\r\n        p5.noFill();\r\n\r\n        // draw handle\r\n        this.handle.draw(p5);\r\n\r\n        // draw beam\r\n        this.beam.draw(p5, this.handle.getDirection(p5));\r\n    }\r\n\r\n    // ---- I/O stuff \r\n    // passing interactions down to the handle member\r\n    mousePressed(p5){\r\n        if (this.iPlay()){\r\n            super.mousePressed(p5);\r\n            this.handle.mousePressed(p5);\r\n        }\r\n    }\r\n\r\n    mouseReleased(p5){\r\n        if (this.iPlay()){\r\n            super.mouseReleased(p5);\r\n            this.handle.mouseReleased(p5);\r\n        }\r\n    }\r\n\r\n    mouseDragged(p5){\r\n        if (this.iPlay()){\r\n            super.mouseDragged(p5);\r\n            this.handle.mouseDragged(p5);\r\n        }\r\n    }\r\n\r\n    mouseMoved(p5){\r\n        if (this.iPlay()){\r\n            super.mouseMoved(p5);\r\n            this.handle.mouseMoved(p5);\r\n        }\r\n    }    \r\n}\r\n\r\nexport default Light;","import {InteractiveObject, IO_STATE} from './interactiveObject.js'\r\nimport Handle from \"./handle.js\"\r\nimport {segment_intersection} from \"./auxi\";\r\n\r\n\r\nclass Mirror extends InteractiveObject {\r\n    constructor({location, size, color, alternativeColor, direction, ID, onClick, player}, p5){\r\n        super(location, size);\r\n        this.color = color;\r\n        this.alternativeColor = alternativeColor;\r\n        this.rotation = 0;\r\n        this.strokeWeight = 5;\r\n        this.player = player;\r\n        this.ID = ID;\r\n        // store mirror id, as it can help with debugging\r\n        // this.id = \"mirror_\"+id;\r\n\r\n        \r\n        // generate a random direction and create the handle\r\n        let randDirection = p5.createVector(p5.random(-1, 1), p5.random(-1, 1));\r\n        this.handle = new Handle(this.location, 10, 25, randDirection, this.color, 2);\r\n\r\n        // store the normalized vectors used to calculate reflection angles\r\n        this.reflectionNormals = [null, null];\r\n        this.onClick = onClick;\r\n\r\n        this.tester = new InteractiveObject(this.location, this.size/3);\r\n    }\r\n\r\n    // gets the start and end coordinates of the mirror\r\n    // returns an array of length 2, with each element being an object containing an x & y value\r\n    getPoints(p5){\r\n        // calculate the start and end point of the mirror\r\n        // adjust vector based on the direction set by the handle\r\n        let adjustV = this.handle.getDirection(p5).setMag(this.size/2);\r\n        let adjust = p5.createVector(adjustV.x, adjustV.y).rotate(Math.PI/2);\r\n\r\n        // startpoint of mirror\r\n        let startPoint = p5.createVector(this.location.x, this.location.y);\r\n        startPoint.add(p5.createVector(-adjust.x, -adjust.y));\r\n        // endpoint\r\n        let endPoint = p5.createVector(this.location.x, this.location.y);\r\n        endPoint.add(adjust);\r\n        \r\n        return [{x: startPoint.x, y: startPoint.y}, {x: endPoint.x, y: endPoint.y}];\r\n    }\r\n\r\n    setNormalizedLocation(x, y, p5){\r\n        let tx = x * p5.width;\r\n        let ty = y * p5.height;\r\n        this.tester.location = p5.createVector(tx, ty);\r\n    }\r\n\r\n\r\n    // gets the point of reflection from light.beam and calculates the normalized vector around which to reflect the beam\r\n    getReflection(p5){\r\n        // return the direction vector\r\n        return p5.createVector(this.handle.direction.x, this.handle.direction.y);\r\n    }\r\n\r\n    // is a given coordinate (loc) over this mirror?\r\n    isOver(loc){\r\n        // needs to be rewritten!\r\n        let x = loc.x;\r\n        let y = loc.y;\r\n        return this.location.x <= x && x <= this.location.x + this.strokeWeight &&\r\n            this.location.y <= y && y <= this.location.y + this.size;\r\n    }\r\n\r\n   draw(p5){       \r\n        this.location.x = this.easer(this.tester.location.x, this.location.x)\r\n        this.location.y = this.easer(this.tester.location.y, this.location.y)\r\n        this.handle.location = this.location;\r\n        p5.strokeWeight(this.strokeWeight);\r\n        p5.stroke(this.color);\r\n\r\n        let size = this.size;\r\n        if (this.state === IO_STATE.HOVERING){\r\n            size+=Math.sin(p5.millis())*2;\r\n        }\r\n\r\n        if (this.state === IO_STATE.CLICKED){\r\n            this.onClick();\r\n        }\r\n       \r\n        // draw the line\r\n        let linePoints = this.getPoints(p5);\r\n        p5.line(linePoints[0].x, linePoints[0].y, linePoints[1].x, linePoints[1].y);\r\n\r\n        // draw the handle\r\n        this.handle.draw(p5);\r\n\r\n        // debug: show reflection normals\r\n        let debug = false;\r\n        if(debug) {\r\n            p5.stroke(\"rgba(0, 255, 255, 1)\");\r\n            for(let i=0; i<this.reflectionNormals.length; i++) {\r\n                if(this.reflectionNormals[i]!=null) {\r\n                    p5.line(this.reflectionNormals[i].origin.x, this.reflectionNormals[i].origin.y, this.reflectionNormals[i].vector.x, this.reflectionNormals[i].vector.y);\r\n                }\r\n            }\r\n        }\r\n\r\n        if (this.tester.state == IO_STATE.DRAGGED){\r\n            this.tester.location = p5.createVector(p5.mouseX, p5.mouseY);\r\n            this.location = p5.createVector(p5.mouseX, p5.mouseY);\r\n            this.handle.location = p5.createVector(p5.mouseX, p5.mouseY);\r\n            this.changed = true;\r\n        }\r\n\r\n        if (this.tester.state == IO_STATE.CLICKED){\r\n            this.onClick();\r\n        }\r\n\r\n    }\r\n\r\n    rotate(degrees){\r\n        this.handle.direction.rotate(degrees)\r\n        this.changed = true;\r\n        this.handle.changed = true;\r\n    }\r\n\r\n    iPlayer(){\r\n        return ((this.player == this.color)||(this.player == this.color+\"s\"))\r\n    }\r\n    \r\n\r\n    // ---- I/O stuff \r\n    // passing interactions down to the handle member\r\n    mousePressed(p5){\r\n        // super.mousePressed(p5);\r\n        // console.log(this.player, this.color);\r\n        // super.mousePressed(p5);\r\n        if (this.iPlayer()){\r\n            this.handle.mousePressed(p5);\r\n            this.tester.mousePressed(p5);\r\n        }\r\n    }\r\n\r\n    mouseReleased(p5){\r\n        // super.mouseReleased(p5);\r\n        if (this.iPlayer()){\r\n            this.handle.mouseReleased(p5);\r\n            this.changed = true;\r\n            this.tester.mouseReleased(p5);\r\n        }\r\n    }\r\n\r\n    mouseDragged(p5){\r\n        if (this.iPlayer){\r\n            this.tester.mouseDragged(p5);\r\n            this.handle.mouseDragged(p5);\r\n        }\r\n    }\r\n\r\n    mouseMoved(p5){\r\n        if (this.iPlayer()){\r\n            this.tester.mouseMoved(p5);\r\n            this.handle.mouseMoved(p5);\r\n        }\r\n    }    \r\n}\r\n\r\nexport default Mirror;","export class Grid {\r\n    constructor(spacing, color, p5) {\r\n        this.spacing = spacing;\r\n        this.strokeColor = color;\r\n        this.xCnt = p5.width / this.spacing;\r\n        this.yCnt = p5.height / this.spacing;\r\n        this.diam = this.spacing*2;\r\n        this.debug = false;\r\n        this.p5 = p5;\r\n    }\r\n\r\n    draw() {\r\n        this.p5.noFill();\r\n        this.p5.stroke(this.strokeColor);\r\n        this.p5.strokeWeight(1);\r\n        // draw the circle background pattern\r\n        for(let i=0; i<=Math.ceil(this.xCnt); i++) {\r\n            for(let j=0; j<=Math.ceil(this.yCnt); j++) {\r\n                this.p5.circle(i*this.spacing, j*this.spacing, this.diam);\r\n\r\n                if(this.debug) {\r\n                    // put a marker on the intersections\r\n                    this.p5.circle(i*this.spacing, j*this.spacing, 10);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    // gets a point with x & y and converts it to the nearest grid point\r\n    nearestGridPoint(loc) {\r\n        let x = Math.round(loc.x/this.spacing) * this.spacing;\r\n        let y = Math.round(loc.y/this.spacing) * this.spacing;\r\n        return {x: x, y: y };\r\n    }\r\n}","import React from \"react\";\r\nimport Sketch from \"react-p5\";\r\nimport {getPointOnCircle} from './auxi'\r\nimport Plant from './plant'\r\nimport Light from './light'\r\nimport Mirror from \"./mirror\";\r\nimport { IO_STATE } from \"./interactiveObject\";\r\nimport { ACTIONS as DATA_ACTIONS } from \"../../reducers/DataReducer\"\r\nimport { Grid } from \"./grid\";\r\n\r\n\r\n// ===============================\r\n// ===============================\r\n//      G A M E\r\n// ===============================\r\n// ===============================\r\nexport default ({socket, player, players, safeDistance, scoreUpdate}) => {\r\n\r\n    // enumerations\r\n\r\n    // globals\r\n    const lights        = new Map();\r\n    const plants        = [];\r\n    const mirrors        = [];\r\n    let grid;\r\n\r\n    // -- keep track of all objects we want to draw \r\n    // --- expects they implemented a draw(p5) method\r\n    const toDraw        = [];\r\n\r\n    // -- keep track of all objects we want to interact with \r\n    // --- expects they implemented all interactive methods as defined in the InteractiveObject class\r\n    const toInteract    = [];\r\n\r\n    const settings = {\r\n        background: \"black\"\r\n    }\r\n\r\n    const lightSettings = {\r\n        size: 30, \r\n        controlOffset: 20,\r\n        offset: .4,\r\n        strokeWeight: 2\r\n    };\r\n\r\n    const plantSettings = {\r\n        amount: 1,\r\n        size: 40,\r\n        color: \"grey\",\r\n        alternativeColor: \"lightgreen\"\r\n    }\r\n\r\n    const mirrorSettings = {\r\n        size: 50,\r\n        alternativeColor: \"0f0\"\r\n    }\r\n    \r\n    // ===============================\r\n    //      A U X\r\n    // ===============================\r\n    const getCenter = (p5)=>{\r\n        return p5.createVector(p5.width*.5, p5.height*.5);\r\n    }\r\n\r\n    const getPlayerColor = ()=>{\r\n        if (player == \"green\" || player == \"greens\"){\r\n            return \"green\"\r\n        }\r\n        if (player == \"blue\" || player == \"blues\"){\r\n            return \"blue\"\r\n        }\r\n        return \"red\";\r\n    }\r\n\r\n    // const getRandomPoint = (p5)=> p5.createVector(Math.random()*p5.width, Math.random()*p5.height);\r\n    \r\n    // ===============================\r\n    //      S E T U P\r\n    // =============================== \r\n\tconst setup = (p5, canvasParentRef) => {\r\n        console.log(\"game started\")\r\n        // setup canvas\r\n        if (canvasParentRef && canvasParentRef.offsetWidth){\r\n            console.log(canvasParentRef.offsetWidth)\r\n            p5.createCanvas(canvasParentRef.offsetWidth, window.screen.height).parent(canvasParentRef);\r\n        } else {\r\n            throw \"canvas not found\"\r\n        }\r\n\r\n        grid = new Grid(100, \"grey\", p5);\r\n\r\n        // setup sockets\r\n        socket.on(\"/gameUpdate\", (gameUpdate)=>{\r\n            const colors = [\"red\", \"green\", \"blue\"];\r\n            if (plants.length){\r\n                // update location\r\n\r\n            } else {\r\n                //  instantiate \r\n                gameUpdate.plants.forEach((p, i, arr)=>{\r\n                    plants[i] = new Plant({location: p5.createVector(p.x*p5.width, p.y*p5.height), ID: p.ID,\r\n                        onClick: ()=>{\r\n                            socket.emit(\"/selected\", {type: \"plant\", index: i});\r\n                        }, grid, p5, collisionColor:getPlayerColor() , ...plantSettings});\r\n                    toDraw.push(plants[i]);\r\n                    toInteract.push(plants[i]);\r\n                });\r\n            }\r\n\r\n            if (mirrors.length){\r\n                // update\r\n                mirrors.forEach((mirror, i)=>{\r\n                    if (mirror && mirror.state == IO_STATE.UNSELECTED && mirror.handle.state == IO_STATE.UNSELECTED && gameUpdate.mirrors[i]){\r\n                        const newmirror = gameUpdate.mirrors[i];\r\n                        mirror.handle.target = p5.createVector(newmirror.rx, newmirror.ry);\r\n                        mirror.setNormalizedLocation(newmirror.x, newmirror.y, p5);\r\n                    }\r\n                })\r\n            } else {\r\n                gameUpdate.mirrors.forEach((m, i, arr)=>{\r\n                    mirrors[i] = new Mirror({location: p5.createVector(m.x*p5.width, m.y*p5.height), player, color: m.player, ID: m.ID || Math.random(),\r\n                        onClick: ()=>{\r\n                            socket.emit(\"/selected\", {type: \"mirror\", index: i});\r\n                        },\r\n                        ...mirrorSettings}, p5);\r\n                    const dir = p5.createVector(m.rx, m.ry);\r\n                    mirrors[i].handle.direction  = dir;\r\n                    mirrors[i].handle.target = dir;\r\n                    toDraw.push(mirrors[i]);\r\n                    toInteract.push(mirrors[i]);\r\n                });\r\n\r\n                colors.forEach((color, i)=>{\r\n                    \r\n                        lights.set(color, new Light(\r\n                            {\r\n                                color, \r\n                                player,\r\n                                hide: !players[color],\r\n                                location: getPointOnCircle(p5, getCenter(p5), p5.width*lightSettings.offset, 3, i),\r\n                                ...lightSettings\r\n                        }, mirrors, p5));\r\n                        toDraw.push(lights.get(color));\r\n                        toInteract.push(lights.get(color));\r\n                    \r\n                })\r\n            }\r\n\r\n            if (lights){\r\n                // update lights position\r\n                colors.forEach(c=>{\r\n                    const l = lights.get(c);\r\n                    if (l && l.state == IO_STATE.UNSELECTED){\r\n                        l.handle.target = p5.createVector(gameUpdate[c].x,gameUpdate[c].y);\r\n                    }\r\n                })\r\n            }\r\n        })\r\n\r\n        socket.on(\"/rotateMirror\", ({index, value})=>{\r\n            if (index && value){\r\n                mirrors[index].rotate(value);\r\n            }\r\n        });\r\n\r\n        socket.on(\"/moveMirror\", ({index, value})=>{\r\n            if (index && value){\r\n                mirrors[index].location.x += value.x || 0;\r\n                mirrors[index].location.y += value.y || 0;\r\n            }\r\n        })\r\n\t};\r\n\r\n\r\n    // ===============================\r\n    //      D R A W\r\n    // =============================== \r\n\tconst draw = (p5) => {\r\n\t\tp5.background(settings.background);\r\n        grid.draw();\r\n        \r\n        toDraw.forEach(td=>td.draw(p5));\r\n        plants.forEach(mr=>mr.detectCollision(lights));\r\n\r\n        [\"red\", \"green\", \"blue\"].forEach(c=>{\r\n            const l = lights.get(c);\r\n            if (l && l.handle.checkChanged()){\r\n                socket.emit(\"/updateLight\", {color: c, rotation: {\r\n                    x: l.handle.target.x,\r\n                    y: l.handle.target.y\r\n                }})\r\n            }\r\n        })\r\n\r\n        mirrors.forEach((mirror, index)=>{\r\n            if (mirror && mirror.handle.checkChanged() || mirror.checkChanged()){\r\n                socket.emit(\"/updateMirror\", \r\n                    {\r\n                        index,\r\n                        x: mirror.location.x / p5.width,\r\n                        y: mirror.location.y / p5.height,\r\n                        rx : mirror.handle.target.x,\r\n                        ry : mirror.handle.target.y\r\n                    }\r\n                )\r\n            }\r\n        })\r\n\r\n\r\n        if (p5.frameCount%scoreUpdate == 0){\r\n            let score = 0;\r\n\r\n            socket.emit(\"/giveGameUpdate\");\r\n            if (plants && plants[0]){\r\n                socket.emit(\"/lights\", plants.map((p, index)=>{\r\n                    if (p.currentColors[player]){\r\n                        score++;\r\n                    }\r\n\r\n                    const colors = {\r\n                        red: p.currentColors.red,\r\n                        green: p.currentColors.green,\r\n                        blue: p.currentColors.blue\r\n                    }\r\n\r\n                    p.currentColors = {\r\n                        red: false,\r\n                        green: false,\r\n                        blue: false\r\n                    };\r\n                    return {\r\n                    index,\r\n                    colors\r\n                }}))\r\n            }\r\n\r\n\r\n\r\n            socket.emit(\"/score\", {player, score})\r\n\r\n        }\r\n\t};\r\n\r\n    // ===============================\r\n    //      I / O\r\n    // =============================== \r\n\tconst mousePressed = (p5)=>{\r\n        toInteract.forEach(ti=>ti.mousePressed(p5));\r\n\t}\r\n\r\n    const mouseReleased = (p5)=>{\r\n        toInteract.forEach(ti=>ti.mouseReleased(p5));\r\n    }\r\n\r\n    const mouseDragged = (p5)=>{\r\n        toInteract.forEach(ti=>ti.mouseDragged(p5));\r\n    }\r\n\r\n    const mouseMoved = (p5)=>{\r\n        toInteract.forEach(ti=>ti.mouseMoved(p5));\r\n    }\r\n\r\n\treturn <Sketch  setup={setup} \r\n                    draw={draw} \r\n                    mousePressed={mousePressed} \r\n                    mouseReleased={mouseReleased} \r\n                    mouseDragged={mouseDragged}\r\n                    mouseMoved={mouseMoved}\r\n                    \r\n                    />;\r\n};\r\n","import React, {useEffect, useState} from 'react';\r\nimport {useSelector} from 'react-redux';\r\n\r\nconst SensorType = ({name, description})=>{\r\n    const [open, setOpen] = useState(false);\r\n\r\n    const toggle = ()=>{\r\n        setOpen(!open);\r\n    }\r\n\r\n    return <div >\r\n\r\n            {open?<br/>:null}\r\n        \r\n            <span>\r\n            --->&nbsp;\r\n            </span>\r\n            <span className=\"hoverer\" onClick={toggle}>\r\n                [{name}] {open?<span>[X]</span>:null}\r\n            </span>\r\n        \r\n        <br/>\r\n        {open?\r\n        <div className=\"indenter\" >\r\n            {description}\r\n            <br/><br/>\r\n        </div> : null}\r\n    </div>\r\n\r\n}\r\n\r\nconst SensorTypes = ()=>{\r\n    const sensorTypes = useSelector(state => state.data.sensorTypes)\r\n    const [open, setOpen] = useState(false);\r\n\r\n    const toggle = ()=>{\r\n        setOpen(!open);\r\n    }\r\n\r\n    if (!sensorTypes){\r\n        return null;\r\n    }\r\n\r\n    return <div>\r\n        <span >\r\n            --> <span className=\"hoverer\" onClick={toggle}>  SENSORTYPES   {open?<span>[X]</span>:null}</span>\r\n        </span>\r\n        \r\n        {open?sensorTypes.map(st=><SensorType key={st.name} name={st.name} description={st.description} />):null}\r\n    </div>\r\n\r\n    \r\n}\r\n\r\nexport default SensorTypes;","import React, {useEffect, useState} from 'react';\r\nimport {useSelector} from 'react-redux';\r\n\r\nconst Sensor = ({type, value})=>{\r\n    const [history, setHistory] = useState([]);\r\n\r\n    useEffect(()=>{\r\n\r\n    })\r\n\r\n    return <div className=\"indenter\">\r\n        {type} - {value}\r\n    </div>\r\n\r\n}\r\n\r\nexport const Plant = ({name, sensors, init})=>{\r\n    const [open, setOpen] = useState(init);\r\n\r\n    const toggle = ()=>{\r\n        setOpen(!open);\r\n    }\r\n\r\n    return <div >\r\n\r\n            {open?<br/>:null}\r\n        \r\n            <span>\r\n            --->&nbsp;\r\n            </span>\r\n            <span className=\"hoverer\" onClick={toggle}>\r\n                [{name}] {open?<span>[X]</span>:null}\r\n            </span>\r\n        \r\n        <br/>\r\n        {open?\r\n        <div className=\"indenter\" >\r\n            {sensors.map((s, i)=><Sensor key={\"sensor\"+i} type={s.type} value={s.value} />)}\r\n            <br/><br/>\r\n        </div> : null}\r\n    </div>\r\n\r\n}\r\n\r\nconst Plants = (plantClusters)=>{\r\n    const [open, setOpen] = useState(false);\r\n\r\n\r\n    const toggle = ()=>{\r\n        setOpen(!open);\r\n    }\r\n\r\n    \r\n\r\n    useEffect(()=>{\r\n        \r\n    })\r\n\r\n    if (!plantClusters){\r\n        return null;\r\n    }\r\n\r\n    return <div>\r\n        <span >\r\n            --> <span className=\"hoverer\" onClick={toggle}>  PLANTS   {open?<span>[X]</span>:null}</span>\r\n        </span>\r\n        \r\n        {open?plantClusters.plantClusters.map(p=><Plant key={p.name} name={p.name} sensors={p.sensors} />):null}\r\n    </div>\r\n\r\n    \r\n}\r\n\r\nexport default Plants;","import React, {useState, useEffect} from \"react\";\r\n\r\nconst Countdown = ({target, displaytext, endText})=>{\r\n    const [rt, setrt] = useState(null);\r\n    const [count, setCount] = useState(0);\r\n  \r\n    const secondsToTarget = ()=>{\r\n      if (rt){\r\n        return Math.floor(Math.abs((new Date().getTime() - rt.getTime()) / 1000));\r\n      } else {\r\n        return null;\r\n      }\r\n    }\r\n  \r\n    useEffect(()=>{\r\n      let int = null;\r\n  \r\n      if (target !== rt){\r\n        setrt(target);\r\n        setCount(null);\r\n      }\r\n  \r\n      if (rt){\r\n        int = setInterval(()=>{\r\n          setCount(secondsToTarget());\r\n        }, 500);\r\n      }\r\n  \r\n      return ()=>{\r\n        if(int){\r\n          clearInterval(int)\r\n        }\r\n      }\r\n    })\r\n  \r\n    if (!target || !rt || !count){\r\n      return null;\r\n    } else if (count && count > 0){\r\n      return <div>\r\n        {displaytext}: {count}\r\n      </div>\r\n    } else {\r\n      return <div> {endText} </div>\r\n    } \r\n  }\r\n\r\nexport default Countdown;","import React, {useEffect, useState} from 'react';\r\nimport { useSelector } from \"react-redux\";\r\nimport { Grid, Col, Row, Theme} from '../theme'\r\nimport SensorTypes from './sensorTypes';\r\nimport Plants, {Plant} from './plants';\r\nimport Countdown from './countdown';\r\n\r\nconst Controller = ({phase, phases, target, player})=>{\r\n    const [theme, socket, client, gameSettings, sensorTypes] = useSelector(state => \r\n        [ state.data.theme, \r\n          state.data.socket, \r\n          state.data.client, \r\n          state.data.gameSettings,\r\n          state.data.sensorTypes,\r\n        ]);\r\n    const [plantClusters, setPlantClusters] = useState(null);\r\n    const [selected, setSelected] = useState(null);\r\n    const [score, setScore] = useState(null);\r\n    const [highScore, setHighScore] = useState(null);\r\n    const ROT = 3;\r\n    const TRA = 10;\r\n\r\n    useEffect(()=>{\r\n        if (socket){\r\n            socket.on(\"/selected_\", (selector)=>{\r\n                setSelected(selector);\r\n            })\r\n\r\n            socket.on(\"/updateSensors\", (plantClusters)=>{\r\n                setPlantClusters(plantClusters);\r\n            });\r\n\r\n            socket.on(\"/score_\", (score_)=>{\r\n                setScore(score_)\r\n            })\r\n\r\n            socket.on(\"/highscore\", (highscore_)=>{\r\n                setHighScore(highscore_);\r\n                console.log(highscore_);\r\n            })\r\n        }\r\n\r\n        return ()=>{\r\n            socket.off(\"/selected_\");\r\n            socket.off(\"/updateSensors\");\r\n            socket.off(\"/score_\");\r\n            socket.off(\"/highscore\");\r\n        }\r\n    })\r\n\r\n    \r\n    if (!theme || !client || !gameSettings || !socket || !sensorTypes || !plantClusters){\r\n        return null;\r\n    }  \r\n\r\n    const getSelected = ()=>{\r\n        if (selected && selected.type){\r\n            switch (selected.type){\r\n                case \"plant\":\r\n                    return <div> <br/>\r\n                        -> Selection <br/>\r\n                        {\r\n                            (()=>{\r\n                                const p = plantClusters[selected.index];\r\n                                return <Plant init={true} key={p.name} name={p.name} sensors={p.sensors} />\r\n                            })()\r\n                        }\r\n                        --------------------- <br/><br/>\r\n                    </div>\r\n                case \"mirror\":\r\n                    const getVal = (value)=>{\r\n                        return {index: selected.index, value}\r\n                    }\r\n                    return <div>\r\n                        -> Mirror selected: [{selected.index}] <br/><br/>\r\n                                <table>\r\n                                    <tbody>\r\n                                    <tr >\r\n                                        <td  onClick={()=>{\r\n                                            socket.emit(\"/rotateMirror_\", getVal(ROT));\r\n                                        }}>\r\n                                            TURN LEFT\r\n                                        </td>\r\n                                        <td onClick={()=>{\r\n                                            socket.emit(\"/rotateMirror_\", getVal(-ROT));\r\n                                        }}>\r\n                                            TURN RIGHT\r\n                                        </td>\r\n                                    </tr>\r\n                                    <tr>\r\n                                        <td onClick={()=>{\r\n                                            socket.emit(\"/moveMirror_\", getVal({y: -TRA}));\r\n                                        }}>\r\n                                            GO UP\r\n                                        </td>\r\n                                        <td onClick={()=>{\r\n                                            socket.emit(\"/moveMirror_\", getVal({y: TRA}));\r\n                                        }}>\r\n                                            GO DOWN\r\n                                        </td>\r\n                                    </tr>\r\n                                    <tr>\r\n                                        <td onClick={()=>{\r\n                                            socket.emit(\"/moveMirror_\", getVal({x: -TRA}));\r\n                                        }}>\r\n                                            GO LEFT\r\n                                        </td>\r\n                                        <td onClick={()=>{\r\n                                            socket.emit(\"/moveMirror_\", getVal({x: TRA}));\r\n                                        }}>\r\n                                            GO RIGHT\r\n                                        </td>\r\n                                    </tr>\r\n                                    </tbody>\r\n                                </table>\r\n                                <br/><br/><br/>\r\n                    </div>\r\n                default:\r\n                    return \"wrong selection\"\r\n            }\r\n        } else {\r\n            return null;\r\n        }\r\n    }\r\n\r\n    return <div>\r\n                <br/>\r\n                <p>\r\n                    ||==================================||\r\n                        &nbsp;&nbsp;&nbsp; BIOMODD [BRG<sup>13</sup>] SPECTRUM\r\n                    ||==================================||\r\n                </p>\r\n                \r\n                <div> \r\n                    GameStatus = {phase} \r\n                </div>\r\n\r\n                {getSelected()}\r\n\r\n                <div>\r\n                    {player? <span>PlayerColor = {player} </span> : null}\r\n                </div>\r\n                <div>\r\n                    {(target && phase == phases.RUNNING)? <span> \r\n                        <Countdown target={target} displaytext={\"Time remaining\"} endText={\"THE END\"} /> <br/>\r\n                        </span> : null}\r\n                </div>\r\n\r\n                <br/>\r\n\r\n                <div>\r\n                {score?<div>\r\n                            -- SCORE <br/>\r\n                            RED: {score.red} <br/>\r\n                            GREEN: {score.green} <br/>\r\n                            BLUE: {score.blue} <br/>\r\n                            TOTAL: {score.red+score.green+score.blue}\r\n                        </div>:null}\r\n                {highScore?<div>\r\n                    HIGHSCORE_INDIVIDUAL: {highScore.HS1} <br />\r\n                    HIGHSCORE_TOTAL: {highScore.HSA} <br />\r\n                </div>:null}\r\n\r\n                </div>\r\n                \r\n\r\n                <SensorTypes />\r\n                <Plants plantClusters={plantClusters} />\r\n                {/* {sensorTypes.map(st=><div>\r\n                    {st.name}\r\n                </div>)} */}\r\n\r\n    </div>;\r\n}\r\n\r\nexport default Controller;","import React from 'react'\r\n\r\nconst Score = ({socket})=>{\r\n    return \"i will be score\";\r\n}\r\n\r\nexport default Score;","import React from 'react';\r\nimport Countdown from './countdown';\r\n\r\nconst LoaderScreen = ({player, players, socket, setPlayer, target})=>{\r\n\r\n\r\n    const MakePlayer = (color)=>{\r\n\r\n        const killed = <div className=\"kill\" >\r\n          [PLAY {color.toUpperCase()}]\r\n        </div>;\r\n  \r\n        const selected = <div>\r\n          [{color.toUpperCase()} SELECTED]\r\n        </div>;\r\n  \r\n        if (player){\r\n          if (player == color){\r\n            return selected;\r\n          } else if (player == color+\"s\"){\r\n              return selected;\r\n          } else {\r\n            return killed;\r\n          }\r\n        }\r\n  \r\n        if (players[color] && players[color+\"s\"]){\r\n          return killed;\r\n        } else if (players[color]){\r\n          return <div className=\"hoverer\" onClick={()=>{\r\n            if (!player){\r\n              socket.emit(\"/startgame\", color+\"s\");\r\n              setPlayer(color+\"s\");\r\n            }\r\n          }}>\r\n            [PLAY {color.toUpperCase()} support]\r\n          </div>\r\n        } else {\r\n          return <div className=\"hoverer\" onClick={()=>{\r\n            if (!player){\r\n              socket.emit(\"/startgame\", color);\r\n              setPlayer(color)\r\n            }\r\n          }}>\r\n            [PLAY {color.toUpperCase()}]\r\n          </div>\r\n        }\r\n      }\r\n\r\n    \r\n      \r\n    return <div style={{color: \"white\"}}>\r\n            <div style={{color: \"white\", width: \"100%\", textAlign:\"center\"}}>\r\n              <br/><br/><br/>\r\n              || ==== LOAD NEW GAME ==== ||\r\n              <br/><br/>\r\n  \r\n              <div >\r\n                {MakePlayer(\"red\")}\r\n                {MakePlayer(\"green\")}\r\n                {MakePlayer(\"blue\")}\r\n              </div>\r\n  \r\n              <br/><br/><br/>\r\n              <Countdown target={target} displaytext={\"Time before launch\"} endText=\"LETS GO\"/>\r\n            </div>\r\n    </div> \r\n}\r\n\r\nexport default LoaderScreen;","import React, {useEffect, useState} from 'react';\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport { Col, Row} from '../theme'\r\nimport Spectrum from '../components/spectrum'\r\nimport { FullScreen, useFullScreenHandle } from \"react-full-screen\";\r\nimport Controller from './controller'\r\nimport Score from './score';\r\nimport LoaderScreen from './LoaderScreen';\r\nimport { ACTIONS as DATA_ACTIONS } from \"../reducers/DataReducer\"\r\n\r\nconst Game = ()=>{\r\n\r\n    const PHASES = Object.freeze({\r\n      LOAD: \"load\",\r\n      RUNNING: \"running\",\r\n      END: \"ended\"\r\n    });\r\n\r\n    const [theme, socket, client, gameSettings, plantClusters, sensorTypes] = useSelector(state => \r\n      [ state.data.theme, \r\n        state.data.socket, \r\n        state.data.client, \r\n        state.data.gameSettings,\r\n        state.data.plantClusters,\r\n        state.data.sensorTypes\r\n      ]);\r\n    const [start, setStart] = useState(null);\r\n    const [phase, setPhase] = useState(PHASES.END);\r\n    const [players, setPlayers] = useState(null);\r\n    const [player, setPlayer] = useState(null);\r\n    const [target, setTarget] = useState(null);\r\n    const [listeners, setListeners] = useState(null);\r\n    const dispatch = useDispatch();\r\n    const handle = useFullScreenHandle();\r\n\r\n    const gamewidth = 9;\r\n    \r\n    const setTargetFromDate = (seconds)=>{\r\n      const d = new Date();\r\n      d.setSeconds( d.getSeconds() + seconds);\r\n      setTarget(d)\r\n    }\r\n\r\n    useEffect(()=>{\r\n      if (socket){\r\n        setListeners(true);\r\n        socket.on(\"/phase\", (newphase)=>{\r\n          setPhase(newphase);\r\n          switch(newphase){\r\n            case PHASES.END:\r\n              setPlayer(null);\r\n              setTarget(null);\r\n              break;\r\n            case PHASES.LOAD:\r\n              if (gameSettings){\r\n                setTargetFromDate(gameSettings.beginningTime);\r\n              }\r\n              break;\r\n            case PHASES.RUNNING:\r\n              if (gameSettings){\r\n                setTargetFromDate(gameSettings.duration);\r\n              }\r\n              break;\r\n          } \r\n        })\r\n\r\n        if (!players){\r\n          socket.emit(\"/givePlayers\"); \r\n        }\r\n    \r\n        socket.on(\"/players\", (newplayers)=>{\r\n          setPlayers(newplayers);\r\n        })\r\n      }\r\n\r\n      return ()=>{\r\n        // clean up our listeners here\r\n        if (socket){\r\n          socket.off(\"/phase\");\r\n          socket.off(\"/players\");\r\n          setListeners(false);\r\n        }\r\n      }\r\n    }, [listeners, setListeners, socket, gameSettings])\r\n\r\n    const go = ()=>{\r\n        setStart(true);\r\n        handle.enter();\r\n    }\r\n\r\n    const content = ()=>{\r\n      switch(phase){\r\n        case PHASES.LOAD : \r\n        case PHASES.END :\r\n          return <LoaderScreen player={player} players={players} socket={socket} setPlayer={setPlayer} target={target} />\r\n        case PHASES.RUNNING : \r\n          return <Spectrum \r\n                      socket={socket} \r\n                      player={player} \r\n                      players={players} \r\n                      scoreUpdate={gameSettings.scoreUpdate} \r\n                      />;\r\n      }\r\n    }\r\n\r\n    if (!theme || !client || !gameSettings || !players){\r\n        return null;\r\n    }\r\n\r\n    return <div>\r\n      {start?null:<button onClick={go}>LOAD</button>}\r\n\r\n      <FullScreen handle={handle}>\r\n        <Row>\r\n          <Col xs={12} sm={12} md={gamewidth}>\r\n            <theme.Empty style={{padding: \"0\", margin: \"0\"}}>\r\n              <div style={{width: \"100%\", height: \"100vh\"}}> \r\n                {(gameSettings)?start?content():content() : null}\r\n                </div>\r\n                <div>\r\n                  <Score socket={socket} />\r\n                </div>\r\n            </theme.Empty>\r\n          </Col>\r\n          <Col xs={12} md={12-gamewidth} style={{background: \"black\", color: \"white\", borderLeft: \"solid 2px white\"}}>\r\n            <Controller phase={phase} phases={PHASES} target={target} player={player} />\r\n          </Col>\r\n        </Row>\r\n      </FullScreen>\r\n    </div>\r\n}\r\n\r\nexport default Game;\r\n\r\n\r\n","import Theme from '../theme'\r\n\r\n\r\nclass BuilderTheme extends Theme {\r\n    constructor(){\r\n      super()\r\n      this.font = \"Fira Code\"\r\n      this.sizes.normal = \"1.2em\"\r\n    }\r\n  \r\n    get defaultFont(){\r\n      return `${super.defaultFont}font-weight: 400;`\r\n    }\r\n  \r\n    get Title(){\r\n      return this.styled(super.Title)` font-weight: bold;`\r\n    }\r\n  }\r\n  \r\n  \r\n\r\n  export default BuilderTheme;","import React, {useState, useEffect, useRef} from 'react';\r\nimport { Grid, Col, Row} from '../theme'\r\nimport { useSelector } from \"react-redux\";\r\nimport Nav from '../components/nav'\r\n\r\nimport BlockContent from '@sanity/block-content-to-react';\r\nimport { NavLink } from 'react-router-dom';\r\nimport Moment from 'react-moment';\r\n\r\n\r\nconst Home = ()=>{\r\n    const theme = useSelector(state => state.data.theme);\r\n    const news = useSelector(state => state.data.news);\r\n    const events = useSelector(state=>state.data.events)\r\n    const faqs = useSelector(state=>state.data.faqs)\r\n    const newsref = useRef(null);\r\n    \r\n    if (!theme){\r\n        return null;\r\n    } else {\r\n\r\n      const getEvents = (events)=>events.map(({title, description, available, moment})=><div key={title}>\r\n      <theme.SubTitle>\r\n        <Moment format=\"DD/MM\">{moment}</Moment> &nbsp;&nbsp; {title}\r\n      </theme.SubTitle>\r\n      <theme.Text>\r\n          <BlockContent blocks={description} />\r\n      </theme.Text>\r\n      <theme.Text>\r\n          <i>\r\n            Available places: {available}\r\n          </i>\r\n      </theme.Text>\r\n      <br/>                  <br/>                  <br/>\r\n    </div>)\r\n        \r\n  \r\n    return <Row align=\"center\">\r\n      <Col xs={12}>\r\n      <Nav />\r\n      </Col>\r\n        \r\n        \r\n      <Col xs={12} sm={8} md={6}>\r\n          <theme.Container>\r\n            <br/><br/>\r\n            <theme.Wrapped>\r\n              <theme.Container>\r\n                <theme.Title ref={newsref}>\r\n                    NEWS\r\n                </theme.Title>\r\n                <br/>\r\n\r\n                {news?\r\n\r\n                news.map(({title, description, images})=><>\r\n                  <theme.SubTitle key={title}>\r\n                    {title}\r\n                  </theme.SubTitle>\r\n                  <theme.Text>\r\n                      <BlockContent blocks={description} />\r\n                  </theme.Text>\r\n                  {(images && images.length)?\r\n                  images.map(({title, description, image})=><>\r\n                      <theme.Text key={title}>\r\n                        <b>\r\n                        {title}\r\n                        </b>\r\n                      </theme.Text>\r\n                      <img src={image} alt={title} style={{width: \"100%\"}} />\r\n                      <theme.Text>\r\n                        <i>\r\n                        <BlockContent blocks={description} />\r\n                        </i>\r\n                      </theme.Text>\r\n                  </>)\r\n                  : null}\r\n                  <br/>\r\n                </>)\r\n                \r\n                : <theme.Text>L O A D I N G</theme.Text>}\r\n              </theme.Container>\r\n            </theme.Wrapped>\r\n          </theme.Container>\r\n        </Col>\r\n\r\n        <Col xs={12} sm={8} md={6}>\r\n          <theme.Container>\r\n            <br/><br/>\r\n            <theme.Wrapped>\r\n              <theme.Container>\r\n                <theme.Title >\r\n                    Frequently Asked Questions\r\n                </theme.Title>\r\n                <br/>\r\n\r\n                {faqs?\r\n                  faqs.map(({title, description})=><theme.Text key={title}>\r\n                    <b>\r\n                      {title}\r\n                    </b> <br/>\r\n                    <BlockContent blocks={description} />\r\n                  </theme.Text>)\r\n                : <theme.Text>L O A D I N G</theme.Text>}\r\n\r\n                <br/>\r\n                             \r\n\r\n              </theme.Container>\r\n            </theme.Wrapped>\r\n          </theme.Container>\r\n\r\n          <theme.Container>\r\n            <br/><br/>\r\n            <theme.Wrapped>\r\n              <theme.Container>\r\n                <theme.Title >\r\n                    EVENTS\r\n                </theme.Title>\r\n                <br/>\r\n\r\n                {events?\r\n                  getEvents(events.filter((e)=>{\r\n                    const today = new Date()\r\n                    const yesterday = new Date(today)\r\n                    yesterday.setDate(yesterday.getDate() - 1)\r\n                    return new Date(e.moment) >= yesterday;\r\n                  }))                \r\n                : <theme.Text>L O A D I N G</theme.Text>}\r\n\r\n                <br/>\r\n                <theme.Title >\r\n                    PAST EVENTS\r\n                </theme.Title>\r\n                <br/>\r\n\r\n\r\n                {events?\r\n                  getEvents(events.filter((e)=>{\r\n                    const today = new Date()\r\n                    const yesterday = new Date(today)\r\n                    yesterday.setDate(yesterday.getDate() - 1)\r\n                    return new Date(e.moment) < yesterday;\r\n                  }))                \r\n                : null}                \r\n\r\n              </theme.Container>\r\n            </theme.Wrapped>\r\n          </theme.Container>\r\n        </Col>\r\n\r\n        \r\n\r\n        \r\n\r\n      </Row>\r\n      \r\n    \r\n    }\r\n\r\n    \r\n  }\r\n\r\nexport default Home;","import React, {useEffect} from 'react';\r\nimport Theme, {OverviewPage} from './theme'\r\nimport { Provider } from \"react-redux\";\r\nimport { Router, Route, Switch } from \"react-router-dom\";\r\nimport Store from \"./Store\";\r\nimport { createBrowserHistory } from 'history';\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport { ACTIONS as DATA_ACTIONS } from \"./reducers/DataReducer\"\r\nimport sanityclient from './client';\r\nimport Server from './components/server'\r\n\r\n\r\nimport { Grid, Col, Row} from './theme'\r\nimport Game from './components/game'\r\n\r\n\r\nimport './assets/fonts/'\r\nimport BuilderTheme from './services/Buildertheme'\r\nimport Home from './components/Home'\r\n\r\nconst DataHelper = () => {\r\n  const data = useSelector(state => state.data);\r\n  const dispatch = useDispatch();\r\n  useEffect(() => {\r\n    if (!data.client && dispatch){\r\n      const cli = sanityclient(dispatch);\r\n      dispatch({ type: DATA_ACTIONS.SET_CLIENT, client: cli});\r\n    } \r\n\r\n    if (!data.theme && dispatch ){\r\n      const builder = new BuilderTheme();\r\n      dispatch({type: DATA_ACTIONS.SET_THEME, theme: new BuilderTheme()})\r\n      // dispatch({type: DATA_ACTIONS.SET_THEMES, themes: [new BuilderTheme()]})\r\n    }\r\n  })\r\n  return (\r\n    null\r\n  )\r\n}\r\n\r\n\r\nconst App =()=>{\r\n  const history = createBrowserHistory()\r\n  const theme = new BuilderTheme();\r\n\r\n  return (\r\n    <Provider store={Store}>\r\n    <DataHelper />\r\n      <Router history={history}>\r\n\r\n        <Grid style={{width: \"100%\", minWidth: \"100%\", margin: 0, padding: 0}}>\r\n\r\n        \r\n\r\n        \r\n        \r\n      \r\n        <span>\r\n       \r\n            <Switch>\r\n              <Route exact path=\"/\" component={Game} />\r\n              {/* <Route exact path=\"/overview\" component={OverviewPage} />\r\n              <Route exact path=\"/server\" component={Server} /> */}\r\n              <Route exact path=\"/gamelegacy\" component={Game} />\r\n              <Route component={Home}/>\r\n            </Switch>\r\n        </span>\r\n\r\n        </Grid>\r\n      </Router>\r\n  </Provider>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.0/8 are considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport function register(config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl, {\r\n    headers: { 'Service-Worker': 'script' },\r\n  })\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready\r\n      .then(registration => {\r\n        registration.unregister();\r\n      })\r\n      .catch(error => {\r\n        console.error(error.message);\r\n      });\r\n  }\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport App from './App';\r\nimport * as serviceWorker from './serviceWorker';\r\n\r\n\r\n// import './assets/fonts/OCP'\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n","module.exports = __webpack_public_path__ + \"static/media/logo.5e69a12b.svg\";"],"sourceRoot":""}